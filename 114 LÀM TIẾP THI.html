<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng C·ª• Xem Gi·ªõi T√≠nh Thai Nhi v√† Ph√¢n T√≠ch Affiliate</title>
    <style>
        /* CSS C∆° B·∫£n v√† Ph·∫£n H·ªìi */
        :root {
            font-size: 16px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
        }

        h1 {
            text-align: center;
            color: #007bff;
            margin-bottom: 30px;
            font-size: 1.8rem;
        }

        .card {
            background-color: #e9ecef;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 5px solid #007bff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        h2 {
            color: #007bff;
            margin-top: 0;
            font-size: 1.4rem;
            border-bottom: 1px dashed #ced4da;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        /* ƒê·∫£m b·∫£o ch·ªØ ƒë·∫πp, kh√¥ng tr√†n, kh√¥ng ch√®n d√≤ng */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .input-group, .affiliate-group {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
            word-wrap: break-word; /* Quan tr·ªçng: ƒê·∫£m b·∫£o ch·ªØ kh√¥ng b·ªã tr√†n */
        }

        input[type="number"], input[type="date"] {
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
            font-size: 1rem;
        }

        button {
            padding: 12px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 15px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #218838;
        }

        .result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            background-color: #eaf8f1;
            border: 1px solid #c3e6cb;
            font-weight: bold;
            color: #155724;
            word-wrap: break-word; /* ƒê·∫£m b·∫£o k·∫øt qu·∫£ hi·ªÉn th·ªã kh√¥ng b·ªã tr√†n */
        }
        
        /* Ph·∫£n h·ªìi tr√™n m√†n h√¨nh l·ªõn h∆°n */
        @media (min-width: 600px) {
            .content-grid {
                grid-template-columns: 1fr 1fr;
            }

            .affiliate-group {
                grid-column: span 2;
            }
        }

        /* CSS cho c√°c nh√≥m kh√¥ng li√™n quan */
        .card-3, .card-4 {
             border-left-color: #dc3545; /* M√†u kh√°c ƒë·ªÉ ph√¢n bi·ªát */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>C√¥ng C·ª• T·ªïng H·ª£p: D·ª± ƒêo√°n Gi·ªõi T√≠nh & Ph√¢n T√≠ch Shopee Affiliate</h1>
        
        <div class="card card-1">
            <h2>üë∂ Th·∫ª 1: D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi (Theo Tu·ªïi √Çm L·ªãch)</h2>
            <div class="content-grid">
                <div class="input-group">
                    <label for="birthDate">Ng√†y th√°ng nƒÉm sinh N·ªØ (D∆∞∆°ng l·ªãch):</label>
                    <input type="date" id="birthDate" value="2000-01-01">
                </div>
                <div class="input-group">
                    <label for="currentDate">Ng√†y th√°ng hi·ªán t·∫°i (D∆∞∆°ng l·ªãch):</label>
                    <input type="date" id="currentDate" value="2025-12-12">
                </div>
                <div class="input-group">
                    <label for="wifeLunarAge">Tu·ªïi √Çm L·ªãch N·ªØ (18-45):</label>
                    <input type="number" id="wifeLunarAge" min="18" max="45" value="25">
                </div>
                <div class="input-group">
                    <label for="dueMonthLunar">Th√°ng D·ª± Sinh √Çm L·ªãch (1-12):</label>
                    <input type="number" id="dueMonthLunar" min="1" max="12" value="10">
                </div>
                
                <div class="affiliate-group">
                    <label for="priceAffiliate1">Gi√° s·∫£n ph·∫©m Shopee (45.000 - 200.000):</label>
                    <input type="number" id="priceAffiliate1" min="45000" max="200000" value="100000">
                </div>
                <div class="affiliate-group">
                    <label for="commissionAffiliate1">Hoa h·ªìng (%) (6 - 50):</label>
                    <input type="number" id="commissionAffiliate1" min="6" max="50" value="15">
                </div>
            </div>
            <button onclick="calculateCard1()">Th·ª±c hi·ªán Th·∫ª 1</button>
            <div id="result1" class="result">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y.</div>
        </div>

        <div class="card card-2">
            <h2>ü©∏ Th·∫ª 2: D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi (Theo Ng√†y Kinh)</h2>
            <div class="content-grid">
                <div class="input-group">
                    <label for="dueMonthLunar2">Th√°ng D·ª± Sinh √Çm L·ªãch (1-12):</label>
                    <input type="number" id="dueMonthLunar2" min="1" max="12" value="10">
                </div>
                <div class="input-group">
                    <label for="lastPeriodDay">Ng√†y B·∫Øt ƒê·∫ßu C√≥ Kinh (1-41):</label>
                    <input type="number" id="lastPeriodDay" min="1" max="41" value="25">
                </div>
                 <div class="affiliate-group">
                    <label for="priceAffiliate2">Gi√° s·∫£n ph·∫©m Shopee (45.000 - 200.000):</label>
                    <input type="number" id="priceAffiliate2" min="45000" max="200000" value="100000">
                </div>
                <div class="affiliate-group">
                    <label for="commissionAffiliate2">Hoa h·ªìng (%) (6 - 50):</label>
                    <input type="number" id="commissionAffiliate2" min="6" max="50" value="15">
                </div>
            </div>
            <button onclick="calculateCard2()">Th·ª±c hi·ªán Th·∫ª 2</button>
            <div id="result2" class="result">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y.</div>
        </div>
        
        <div class="card card-3">
            <h2>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Th·∫ª 3: D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi (Theo Tu·ªïi V·ª£/Ch·ªìng √Çm L·ªãch)</h2>
            <div class="content-grid">
                <div class="input-group">
                    <label for="wifeLunarAge3">Tu·ªïi √Çm L·ªãch V·ª£ (1-12):</label>
                    <input type="number" id="wifeLunarAge3" min="1" max="12" value="4">
                </div>
                <div class="input-group">
                    <label for="husbandLunarAge3">Tu·ªïi √Çm L·ªãch Ch·ªìng (1-12):</label>
                    <input type="number" id="husbandLunarAge3" min="1" max="12" value="8">
                </div>
                 <div class="affiliate-group">
                    <label for="priceAffiliate3">Gi√° s·∫£n ph·∫©m Shopee (45.000 - 200.000):</label>
                    <input type="number" id="priceAffiliate3" min="45000" max="200000" value="100000">
                </div>
                <div class="affiliate-group">
                    <label for="commissionAffiliate3">Hoa h·ªìng (%) (6 - 50):</label>
                    <input type="number" id="commissionAffiliate3" min="6" max="50" value="15">
                </div>
            </div>
            <button onclick="calculateCard3()">Th·ª±c hi·ªán Th·∫ª 3</button>
            <div id="result3" class="result">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y.</div>
        </div>

        <div class="card card-4">
            <h2>‚è∞ Th·∫ª 4: D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi (Theo Gi·ªù/Ng√†y)</h2>
            <div class="content-grid">
                <div class="input-group">
                    <label for="hour4">Gi·ªù (1-12):</label>
                    <input type="number" id="hour4" min="1" max="12" value="7">
                </div>
                <div class="input-group">
                    <label for="day4">Ng√†y (1-12):</label>
                    <input type="number" id="day4" min="1" max="12" value="5">
                </div>
                 <div class="affiliate-group">
                    <label for="priceAffiliate4">Gi√° s·∫£n ph·∫©m Shopee (45.000 - 200.000):</label>
                    <input type="number" id="priceAffiliate4" min="45000" max="200000" value="100000">
                </div>
                <div class="affiliate-group">
                    <label for="commissionAffiliate4">Hoa h·ªìng (%) (6 - 50):</label>
                    <input type="number" id="commissionAffiliate4" min="6" max="50" value="15">
                </div>
            </div>
            <button onclick="calculateCard4()">Th·ª±c hi·ªán Th·∫ª 4</button>
            <div id="result4" class="result">K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y.</div>
        </div>
        
    </div>

    <script>
        // C√°c B·∫£ng d·ªØ li·ªáu ƒë√£ cung c·∫•p
        const table1 = {
            18: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T'],
            19: ['T', 'G', 'T', 'G', 'G', 'T', 'G', 'G', 'G', 'G', 'G', 'G'],
            20: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T'],
            21: ['T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G'],
            22: ['G', 'T', 'T', 'G', 'T', 'T', 'T', 'G', 'G', 'G', 'G', 'G'],
            23: ['T', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'G', 'G', 'G', 'G'],
            24: ['T', 'G', 'T', 'T', 'G', 'T', 'T', 'G', 'G', 'G', 'G', 'G'],
            25: ['G', 'T', 'T', 'G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T'],
            26: ['T', 'G', 'T', 'G', 'G', 'T', 'G', 'T', 'G', 'G', 'G', 'G'],
            27: ['G', 'T', 'G', 'T', 'T', 'G', 'T', 'T', 'T', 'G', 'T', 'T'],
            28: ['T', 'G', 'T', 'G', 'G', 'G', 'T', 'T', 'T', 'T', 'G', 'G'],
            29: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T', 'G', 'G', 'G'],
            30: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            31: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            32: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            33: ['G', 'T', 'G', 'T', 'T', 'G', 'G', 'T', 'G', 'G', 'T', 'T'],
            34: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            35: ['T', 'T', 'G', 'T', 'G', 'G', 'G', 'T', 'T', 'T', 'T', 'T'],
            36: ['G', 'T', 'T', 'G', 'T', 'G', 'G', 'T', 'G', 'T', 'T', 'G'],
            37: ['T', 'G', 'T', 'T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'T'],
            38: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'G', 'T', 'G', 'T', 'T'],
            39: ['G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'T', 'G'],
            40: ['G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'T', 'G'],
            41: ['T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'T'],
            42: ['G', 'T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'G', 'G'],
            43: ['T', 'G', 'T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'T', 'T'],
            44: ['T', 'T', 'G', 'T', 'T', 'T', 'G', 'T', 'G', 'T', 'G', 'G'],
            45: ['G', 'T', 'T', 'G', 'G', 'G', 'T', 'G', 'T', 'G', 'T', 'T']
        };

        const table2 = {
            14: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T'],
            15: ['T', 'G', 'T', 'G', 'G', 'T', 'G', 'G', 'G', 'G', 'G', 'G'],
            16: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T', 'T'],
            17: ['T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G'],
            18: ['G', 'T', 'T', 'G', 'T', 'T', 'T', 'G', 'G', 'G', 'G', 'G'],
            19: ['T', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'G', 'G', 'G', 'G'],
            20: ['T', 'G', 'T', 'T', 'G', 'T', 'T', 'G', 'G', 'G', 'G', 'G'],
            21: ['G', 'T', 'T', 'G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T'],
            22: ['T', 'G', 'T', 'G', 'G', 'T', 'G', 'T', 'G', 'G', 'G', 'G'],
            23: ['G', 'T', 'G', 'T', 'T', 'G', 'T', 'T', 'T', 'G', 'T', 'T'],
            24: ['T', 'G', 'T', 'G', 'G', 'G', 'T', 'T', 'T', 'T', 'G', 'G'],
            25: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'T', 'T', 'G', 'G', 'G'],
            26: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            27: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            28: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            29: ['G', 'T', 'G', 'T', 'T', 'G', 'G', 'T', 'G', 'G', 'T', 'T'],
            30: ['T', 'T', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'T', 'T'],
            31: ['T', 'T', 'G', 'T', 'G', 'G', 'G', 'T', 'T', 'T', 'T', 'T'],
            32: ['G', 'T', 'T', 'G', 'T', 'G', 'G', 'T', 'G', 'T', 'T', 'G'],
            33: ['T', 'G', 'T', 'T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'T'],
            34: ['G', 'T', 'G', 'T', 'T', 'T', 'T', 'G', 'T', 'G', 'T', 'T'],
            35: ['G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'T', 'G'],
            36: ['G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'T', 'G'],
            37: ['T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'T', 'G', 'T'],
            38: ['G', 'T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'G', 'G', 'G'],
            39: ['T', 'G', 'T', 'G', 'T', 'G', 'T', 'G', 'T', 'T', 'T', 'T'],
            40: ['T', 'T', 'G', 'T', 'T', 'T', 'G', 'T', 'G', 'T', 'G', 'G'],
            41: ['G', 'T', 'T', 'G', 'G', 'G', 'T', 'G', 'T', 'G', 'T', 'T']
        };
        // C·∫ßn √°nh x·∫° c·ªôt b·∫£ng 2: 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9
        const table2MonthMapping = [9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8];

        const table3 = {
            1: [1, 5, 9, 1, 5, 9, 1, 5, 9, 1, 5, 9],
            2: [10, 2, 6, 10, 2, 6, 10, 2, 6, 10, 2, 6],
            3: [7, 11, 3, 7, 11, 3, 7, 11, 3, 7, 11, 3],
            4: [4, 8, 12, 4, 8, 12, 4, 8, 12, 4, 8, 12],
            5: [1, 5, 9, 1, 5, 9, 1, 5, 9, 1, 5, 9],
            6: [10, 2, 6, 10, 2, 6, 10, 2, 6, 10, 2, 6],
            7: [7, 11, 3, 7, 11, 3, 7, 11, 3, 7, 11, 3],
            8: [4, 8, 12, 4, 8, 12, 4, 8, 12, 4, 8, 12],
            9: [1, 5, 9, 1, 5, 9, 1, 5, 9, 1, 5, 9],
            10: [10, 2, 6, 10, 2, 6, 10, 2, 6, 10, 2, 6],
            11: [7, 11, 3, 7, 11, 3, 7, 11, 3, 7, 11, 3],
            12: [4, 8, 12, 4, 8, 12, 4, 8, 12, 4, 8, 12]
        };

        // H√†m chung ƒë·ªÉ t√≠nh Gi·ªõi t√≠nh (Ch·∫µn/L·∫ª)
        function checkGender(value) {
            return value % 2 === 0 ? 'G√°i (Ch·∫µn)' : 'Trai (L·∫ª)';
        }

        // --- Th·∫ª 1 Logic ---
        function calculateCard1() {
            const birthDateStr = document.getElementById('birthDate').value;
            const currentDateStr = document.getElementById('currentDate').value;
            const wifeLunarAge = parseInt(document.getElementById('wifeLunarAge').value);
            const dueMonthLunar = parseInt(document.getElementById('dueMonthLunar').value);
            const priceAffiliate = parseInt(document.getElementById('priceAffiliate1').value);
            const commissionAffiliate = parseInt(document.getElementById('commissionAffiliate1').value);
            let output = "";

            if (isNaN(wifeLunarAge) || wifeLunarAge < 18 || wifeLunarAge > 45 || isNaN(dueMonthLunar) || dueMonthLunar < 1 || dueMonthLunar > 12) {
                output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë√∫ng Tu·ªïi √Çm L·ªãch N·ªØ (18-45) v√† Th√°ng D·ª± Sinh √Çm L·ªãch (1-12).\n";
            } else {
                // Gi·ªõi t√≠nh Thai Nhi (B·∫£ng 1)
                // Tu·ªïi v·ª£ l√† D√≤ng (Key), Th√°ng d·ª± sinh l√† C·ªôt (Index - 1)
                const genderResult = table1[wifeLunarAge][dueMonthLunar - 1];
                const genderText = genderResult === 'T' ? 'Con Trai' : 'Con G√°i';

                // T√≠nh to√°n s∆° b·ªô Tu·ªïi √Çm L·ªãch v√† Th√°ng D·ª± Sinh (Theo y√™u c·∫ßu)
                const birthYear = new Date(birthDateStr).getFullYear();
                const currentYear = new Date(currentDateStr).getFullYear();
                const birthMonth = new Date(birthDateStr).getMonth() + 1;
                const currentMonth = new Date(currentDateStr).getMonth() + 1;
                
                const calculatedWifeAge = currentYear - birthYear - 1; // L·∫•y nƒÉm √¥ 2 tr·ª´ nƒÉm √¥ 1 tr·ª´ 1
                const calculatedDueMonth = currentMonth - birthMonth - 1; // Th√°ng √¢m l·ªãch b·∫±ng k·∫øt qu·∫£ √¥ 2 - √¥ 1th√°ng tr·ª´ 1
                
                // Ng√†y d·ª± sinh (d∆∞∆°ng l·ªãch)
                let dueDay = new Date(currentDateStr);
                dueDay.setDate(dueDay.getDate() + 285); 
                const dueDayText = dueDay.toLocaleDateString('vi-VN');
                const dueMonthLunarCalc = dueDay.getMonth(); // th√°ng d∆∞∆°ng l·ªãch + 1

                output += `**[D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi - B·∫£ng 1]**\n`;
                output += ` - **Tu·ªïi N·ªØ √Çm L·ªãch:** ${wifeLunarAge}\n`;
                output += ` - **Th√°ng D·ª± Sinh √Çm L·ªãch:** ${dueMonthLunar}\n`;
                output += ` - **K·∫øt qu·∫£ Gi·ªõi T√≠nh:** **${genderText}** (${genderResult})\n\n`;

                output += `**[T√≠nh to√°n c∆° b·∫£n]**\n`;
                output += ` - NƒÉm hi·ªán t·∫°i - NƒÉm sinh - 1: **${calculatedWifeAge}**\n`;
                output += ` - Th√°ng hi·ªán t·∫°i - Th√°ng sinh - 1: **${calculatedDueMonth}**\n`;
                output += ` - Ng√†y D·ª± Sinh (DL) + 285 ng√†y: **${dueDayText}**\n`;
                output += ` - Th√°ng D·ª± Sinh √Çm L·ªãch (-1): **${dueMonthLunarCalc}** (Th√°ng d∆∞∆°ng l·ªãch c·ªßa ng√†y d·ª± sinh - 1)\n\n`;
            }

            // Ph√¢n t√≠ch Shopee Affiliate
            if (isNaN(priceAffiliate) || isNaN(commissionAffiliate)) {
                output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin Affiliate.";
            } else {
                const priceRemainder = priceAffiliate % 45; // Chia 45 l·∫•y s·ªë d∆∞ -> c·ªôt 1 b·∫£ng 1
                const commissionRemainder = commissionAffiliate % 18; // Chia 18 l·∫•y s·ªë d∆∞ -> d√≤ng 1 b·∫£ng 1
                
                // Tra b·∫£ng 1: D√≤ng 1 (Tu·ªïi 18) | C·ªôt 1 (Th√°ng 1)
                // C·ªôt (priceRemainder % 12) -> priceRemainder l√† s·ªë d∆∞ 0-44, c·∫ßn √°nh x·∫° th√†nh 1-12
                // D√≤ng (commissionRemainder % 45) -> commissionRemainder l√† s·ªë d∆∞ 0-17, c·∫ßn √°nh x·∫° th√†nh 18-45
                
                // √Ånh x·∫° sang Index 0-11 (cho c·ªôt) v√† Key 18-45 (cho d√≤ng)
                const columnIndex = (priceRemainder % 12); // L·∫•y s·ªë d∆∞ chia 12 ƒë·ªÉ √°nh x·∫° v√†o 12 c·ªôt (index 0-11)
                const rowIndex = (commissionRemainder % 45) + 18; // L·∫•y s·ªë d∆∞ chia 45 v√† c·ªông 18 ƒë·ªÉ √°nh x·∫° v√†o 18-45 (n·∫øu s·ªë d∆∞ <= 27)

                // Ki·ªÉm tra xem rowIndex c√≥ trong table1 kh√¥ng, m·∫∑c ƒë·ªãnh l·∫•y d√≤ng 18 n·∫øu ngo√†i 18-45
                const finalRowKey = rowIndex in table1 ? rowIndex : 18; 
                
                const affiliateGenderResult = table1[finalRowKey][columnIndex];
                const affiliateGenderText = affiliateGenderResult === 'T' ? 'Con Trai' : 'Con G√°i';


                output += `**[Ph√¢n T√≠ch Shopee Affiliate - B·∫£ng 1]**\n`;
                output += ` - **Gi√° SP (%45):** ${priceRemainder} -> C·ªôt **${columnIndex + 1}**\n`;
                output += ` - **Hoa H·ªìng (%18):** ${commissionRemainder} -> D√≤ng **${finalRowKey}**\n`;
                output += ` - **K·∫øt qu·∫£ Tra b·∫£ng:** **${affiliateGenderText}** (${affiliateGenderResult})\n`;
            }
            
            document.getElementById('result1').innerText = output;
        }


        // --- Th·∫ª 2 Logic ---
        function calculateCard2() {
            const dueMonthLunar = parseInt(document.getElementById('dueMonthLunar2').value);
            const lastPeriodDay = parseInt(document.getElementById('lastPeriodDay').value);
            const priceAffiliate = parseInt(document.getElementById('priceAffiliate2').value);
            const commissionAffiliate = parseInt(document.getElementById('commissionAffiliate2').value);
            let output = "";

            if (isNaN(dueMonthLunar) || dueMonthLunar < 1 || dueMonthLunar > 12 || isNaN(lastPeriodDay) || lastPeriodDay < 14 || lastPeriodDay > 41) {
                output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë√∫ng Th√°ng D·ª± Sinh √Çm L·ªãch (1-12) v√† Ng√†y B·∫Øt ƒê·∫ßu C√≥ Kinh (14-41).\n";
            } else {
                // Gi·ªõi t√≠nh Thai Nhi (B·∫£ng 2)
                // Ng√†y b·∫Øt ƒë·∫ßu c√≥ kinh l√† C·ªôt (Key), Th√°ng d·ª± sinh l√† D√≤ng (Index - C·∫ßn Mapping)
                // B·∫£ng 2: D√≤ng l√† Ng√†y b·∫Øt ƒë·∫ßu c√≥ kinh, C·ªôt l√† Th√°ng d·ª± sinh √¢m l·ªãch (ƒë√£ mapping)
                const columnIndex = table2MonthMapping[dueMonthLunar - 1]; // √Ånh x·∫° 1-12 sang index 0-11 c·ªßa b·∫£ng 2
                const genderResult = table2[lastPeriodDay][columnIndex];
                const genderText = genderResult === 'T' ? 'Con Trai' : 'Con G√°i';

                output += `**[D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi - B·∫£ng 2]**\n`;
                output += ` - **Th√°ng D·ª± Sinh √Çm L·ªãch:** ${dueMonthLunar} -> C·ªôt B·∫£ng 2 Index: **${columnIndex+1}**\n`;
                output += ` - **Ng√†y B·∫Øt ƒê·∫ßu C√≥ Kinh:** ${lastPeriodDay} -> D√≤ng B·∫£ng 2 Key: **${lastPeriodDay}**\n`;
                output += ` - **K·∫øt qu·∫£ Gi·ªõi T√≠nh:** **${genderText}** (${genderResult})\n\n`;
            }

            // Ph√¢n t√≠ch Shopee Affiliate
            if (isNaN(priceAffiliate) || isNaN(commissionAffiliate)) {
                 output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin Affiliate.";
            } else {
                const priceRemainder = priceAffiliate % 41; // Chia 41 l·∫•y s·ªë d∆∞ -> c·ªôt 1 b·∫£ng 2 (0-40, d√πng l√†m d√≤ng)
                const commissionRemainder = commissionAffiliate % 18; // Chia 18 l·∫•y s·ªë d∆∞ -> d√≤ng 1 b·∫£ng 2 (0-17, d√πng l√†m c·ªôt)

                // √Ånh x·∫° sang Index 0-11 (cho c·ªôt) v√† Key 14-41 (cho d√≤ng)
                const columnIndex = (commissionRemainder % 12); // L·∫•y s·ªë d∆∞ chia 12 ƒë·ªÉ √°nh x·∫° v√†o 12 c·ªôt (index 0-11)
                const rowIndex = (priceRemainder % 41) + 14; // L·∫•y s·ªë d∆∞ chia 41 v√† c·ªông 14 ƒë·ªÉ √°nh x·∫° v√†o 14-41

                // Ki·ªÉm tra xem rowIndex c√≥ trong table2 kh√¥ng, m·∫∑c ƒë·ªãnh l·∫•y d√≤ng 14 n·∫øu ngo√†i 14-41
                const finalRowKey = rowIndex in table2 ? rowIndex : 14; 
                
                const affiliateGenderResult = table2[finalRowKey][columnIndex];
                const affiliateGenderText = affiliateGenderResult === 'T' ? 'Con Trai' : 'Con G√°i';

                output += `**[Ph√¢n T√≠ch Shopee Affiliate - B·∫£ng 2]**\n`;
                output += ` - **Gi√° SP (%41):** ${priceRemainder} -> D√≤ng **${finalRowKey}**\n`;
                output += ` - **Hoa H·ªìng (%18):** ${commissionRemainder} -> C·ªôt **${columnIndex + 1}**\n`;
                output += ` - **K·∫øt qu·∫£ Tra b·∫£ng:** **${affiliateGenderText}** (${affiliateGenderResult})\n`;
            }
            
            document.getElementById('result2').innerText = output;
        }

        // --- Th·∫ª 3 Logic ---
        function calculateCard3() {
            const wifeLunarAge = parseInt(document.getElementById('wifeLunarAge3').value);
            const husbandLunarAge = parseInt(document.getElementById('husbandLunarAge3').value);
            const priceAffiliate = parseInt(document.getElementById('priceAffiliate3').value);
            const commissionAffiliate = parseInt(document.getElementById('commissionAffiliate3').value);
            let output = "";

            if (isNaN(wifeLunarAge) || wifeLunarAge < 1 || wifeLunarAge > 12 || isNaN(husbandLunarAge) || husbandLunarAge < 1 || husbandLunarAge > 12) {
                output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë√∫ng Tu·ªïi √Çm L·ªãch V·ª£ v√† Ch·ªìng (1-12).\n";
            } else {
                // Gi·ªõi t√≠nh Thai Nhi (B·∫£ng 3)
                // Tu·ªïi V·ª£ l√† D√≤ng (Key), Tu·ªïi Ch·ªìng l√† C·ªôt (Index - 1)
                const intersectionValue = table3[wifeLunarAge][husbandLunarAge - 1];
                const genderText = checkGender(intersectionValue);

                output += `**[D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi - B·∫£ng 3]**\n`;
                output += ` - **Tu·ªïi V·ª£ √Çm L·ªãch:** ${wifeLunarAge}\n`;
                output += ` - **Tu·ªïi Ch·ªìng √Çm L·ªãch:** ${husbandLunarAge}\n`;
                output += ` - **Gi√° tr·ªã giao ƒëi·ªÉm:** **${intersectionValue}**\n`;
                output += ` - **K·∫øt qu·∫£ Gi·ªõi T√≠nh:** **${genderText}**\n\n`;
            }

            // Ph√¢n t√≠ch Shopee Affiliate
            if (isNaN(priceAffiliate) || isNaN(commissionAffiliate)) {
                 output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin Affiliate.";
            } else {
                const priceRemainder = priceAffiliate % 12; // Chia 12 l·∫•y s·ªë d∆∞ -> c·ªôt 1 b·∫£ng 3
                const commissionRemainder = commissionAffiliate % 18; // Chia 18 l·∫•y s·ªë d∆∞ -> d√≤ng 1 b·∫£ng 3
                
                // √Ånh x·∫° sang Index 0-11 (cho c·ªôt) v√† Key 1-12 (cho d√≤ng)
                const columnIndex = priceRemainder; // C·ªôt: s·ªë d∆∞ 0-11 -> Index 0-11
                const rowIndex = (commissionRemainder % 12) + 1; // D√≤ng: s·ªë d∆∞ 0-11 -> Key 1-12

                const intersectionValue = table3[rowIndex][columnIndex];
                const affiliateGenderText = checkGender(intersectionValue);

                output += `**[Ph√¢n T√≠ch Shopee Affiliate - B·∫£ng 3]**\n`;
                output += ` - **Gi√° SP (%12):** ${priceRemainder} -> C·ªôt **${columnIndex + 1}**\n`;
                output += ` - **Hoa H·ªìng (%18):** ${commissionRemainder} -> D√≤ng **${rowIndex}**\n`;
                output += ` - **Gi√° tr·ªã giao ƒëi·ªÉm:** **${intersectionValue}**\n`;
                output += ` - **K·∫øt qu·∫£ Tra b·∫£ng:** **${affiliateGenderText}**\n`;
            }
            
            document.getElementById('result3').innerText = output;
        }

        // --- Th·∫ª 4 Logic ---
        function calculateCard4() {
            const hour = parseInt(document.getElementById('hour4').value);
            const day = parseInt(document.getElementById('day4').value);
            const priceAffiliate = parseInt(document.getElementById('priceAffiliate4').value);
            const commissionAffiliate = parseInt(document.getElementById('commissionAffiliate4').value);
            let output = "";

            if (isNaN(hour) || hour < 1 || hour > 12 || isNaN(day) || day < 1 || day > 12) {
                output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë√∫ng Gi·ªù v√† Ng√†y (1-12).\n";
            } else {
                // Gi·ªõi t√≠nh Thai Nhi (B·∫£ng 3 - Theo y√™u c·∫ßu)
                // Gi·ªù l√† C·ªôt (Index - 1), Ng√†y l√† D√≤ng (Key)
                const intersectionValue = table3[day][hour - 1];
                const genderText = checkGender(intersectionValue);

                output += `**[D·ª± ƒêo√°n Gi·ªõi T√≠nh Thai Nhi - B·∫£ng 3]**\n`;
                output += ` - **Gi·ªù:** ${hour} -> C·ªôt **${hour}**\n`;
                output += ` - **Ng√†y:** ${day} -> D√≤ng **${day}**\n`;
                output += ` - **Gi√° tr·ªã giao ƒëi·ªÉm:** **${intersectionValue}**\n`;
                output += ` - **K·∫øt qu·∫£ Gi·ªõi T√≠nh:** **${genderText}**\n\n`;
            }

            // Ph√¢n t√≠ch Shopee Affiliate (T∆∞∆°ng t·ª± Th·∫ª 3)
             if (isNaN(priceAffiliate) || isNaN(commissionAffiliate)) {
                 output += "‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin Affiliate.";
            } else {
                const priceRemainder = priceAffiliate % 12; // Chia 12 l·∫•y s·ªë d∆∞ -> c·ªôt 1 b·∫£ng 3
                const commissionRemainder = commissionAffiliate % 18; // Chia 18 l·∫•y s·ªë d∆∞ -> d√≤ng 1 b·∫£ng 3
                
                // √Ånh x·∫° sang Index 0-11 (cho c·ªôt) v√† Key 1-12 (cho d√≤ng)
                const columnIndex = priceRemainder; // C·ªôt: s·ªë d∆∞ 0-11 -> Index 0-11
                const rowIndex = (commissionRemainder % 12) + 1; // D√≤ng: s·ªë d∆∞ 0-11 -> Key 1-12

                const intersectionValue = table3[rowIndex][columnIndex];
                const affiliateGenderText = checkGender(intersectionValue);

                output += `**[Ph√¢n T√≠ch Shopee Affiliate - B·∫£ng 3]**\n`;
                output += ` - **Gi√° SP (%12):** ${priceRemainder} -> C·ªôt **${columnIndex + 1}**\n`;
                output += ` - **Hoa H·ªìng (%18):** ${commissionRemainder} -> D√≤ng **${rowIndex}**\n`;
                output += ` - **Gi√° tr·ªã giao ƒëi·ªÉm:** **${intersectionValue}**\n`;
                output += ` - **K·∫øt qu·∫£ Tra b·∫£ng:** **${affiliateGenderText}**\n`;
            }
            
            document.getElementById('result4').innerText = output;
        }
    </script>
</body>
</html>