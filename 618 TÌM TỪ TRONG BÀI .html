<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tìm Sản Phẩm Phù Hợp</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #333;
            min-height: 100vh;
            padding: 15px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            padding: 20px;
            margin: 10px 0;
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #6a11cb;
        }
        
        .header h1 {
            color: #2575fc;
            font-size: 1.8rem;
            margin-bottom: 8px;
        }
        
        .header p {
            color: #666;
            font-size: 0.95rem;
        }
        
        .section {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.1rem;
            color: #6a11cb;
            margin-bottom: 10px;
            padding-left: 5px;
            border-left: 4px solid #2575fc;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 8px;
            font-size: 1rem;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #444;
            font-size: 0.95rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: #f9f9f9;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #6a11cb;
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.1);
            background-color: #fff;
        }
        
        .people-list {
            max-height: 200px;
            overflow-y: auto;
            border: 2px solid #ddd;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        
        .person-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .person-item:hover {
            background-color: #eef5ff;
        }
        
        .person-item.selected {
            background-color: #e1e8ff;
            border-left: 4px solid #2575fc;
        }
        
        .person-item:last-child {
            border-bottom: none;
        }
        
        .person-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 3px;
        }
        
        .person-dob {
            font-size: 0.9rem;
            color: #666;
        }
        
        .result-box {
            background-color: #f0f7ff;
            border-radius: 10px;
            padding: 15px;
            border: 2px dashed #6a11cb;
            margin-top: 10px;
            font-weight: 500;
            color: #333;
            min-height: 50px;
            display: flex;
            align-items: center;
        }
        
        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        button i {
            margin-right: 8px;
        }
        
        .calculate-btn {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(37, 117, 252, 0.3);
        }
        
        .search-btn {
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            color: white;
        }
        
        .search-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(255, 126, 95, 0.3);
        }
        
        .clear-btn {
            background: linear-gradient(to right, #36d1dc, #5b86e5);
            color: white;
        }
        
        .clear-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(91, 134, 229, 0.3);
        }
        
        .product-category {
            display: inline-block;
            padding: 6px 12px;
            margin: 5px 5px 5px 0;
            background-color: #e1e8ff;
            border-radius: 20px;
            font-size: 0.85rem;
            color: #2575fc;
            border: 1px solid #b8d0ff;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            font-weight: 500;
            display: none;
            max-width: 90%;
            text-align: center;
        }
        
        .notification.error {
            background-color: #f44336;
        }
        
        .notification.show {
            display: block;
            animation: fadeInOut 3s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; top: 0px; }
            10% { opacity: 1; top: 20px; }
            90% { opacity: 1; top: 20px; }
            100% { opacity: 0; top: 0px; }
        }
        
        .highlight {
            background-color: #fff9c4;
            padding: 2px 4px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .result-item {
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px dotted #ddd;
        }
        
        .result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        @media (max-width: 400px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            input, select, textarea {
                padding: 10px 12px;
            }
            
            button {
                padding: 12px;
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-search"></i> Tìm Sản Phẩm Phù Hợp</h1>
            <p>Nhập thông tin và tìm sản phẩm phù hợp với người dùng</p>
        </div>
        
        <div class="section">
            <div class="section-title"><i class="far fa-calendar-alt"></i> Ngày hiện tại</div>
            <div class="input-group">
                <label for="currentDate">Ngày tháng năm hiện tại</label>
                <input type="date" id="currentDate" value="">
            </div>
        </div>
        
        <div class="section">
            <div class="section-title"><i class="fas fa-birthday-cake"></i> Thông tin người</div>
            <div class="input-group">
                <label for="birthDate">Ngày tháng năm sinh</label>
                <input type="date" id="birthDate">
            </div>
            
            <div class="input-group">
                <label for="personName">Tên người</label>
                <input type="text" id="personName" placeholder="Nhập tên người">
            </div>
        </div>
        
        <div class="section">
            <div class="section-title"><i class="fas fa-users"></i> Danh sách người</div>
            <div class="people-list" id="peopleList">
                <!-- Danh sách người sẽ được thêm bằng JavaScript -->
            </div>
        </div>
        
        <div class="section">
            <div class="section-title"><i class="fas fa-calculator"></i> Tính toán</div>
            <div class="buttons">
                <button class="calculate-btn" id="calculateBtn">
                    <i class="fas fa-calculator"></i> Tính toán
                </button>
            </div>
            
            <div class="input-group">
                <label for="diffDays">Số ngày từ 1/1/1900 đến nay</label>
                <input type="text" id="diffDays" readonly>
            </div>
            
            <div class="input-group">
                <label for="modResult">Kết quả chia lấy dư (mod 25)</label>
                <input type="text" id="modResult" readonly>
            </div>
            
            <div class="input-group">
                <label for="foundPerson">Người tìm được</label>
                <input type="text" id="foundPerson" readonly>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title"><i class="fas fa-user-circle"></i> Thông tin người tìm được</div>
            <div class="input-group">
                <label for="lastLetters">Các chữ cái cuối cùng trong tên</label>
                <input type="text" id="lastLetters" readonly>
            </div>
            
            <div class="input-group">
                <label for="personAge">Tuổi của người tìm được</label>
                <input type="text" id="personAge" readonly>
            </div>
            
            <div class="input-group">
                <label>Đề xuất mặt hàng theo lứa tuổi</label>
                <div class="result-box" id="productSuggestions">
                    <!-- Sản phẩm đề xuất sẽ hiển thị ở đây -->
                </div>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title"><i class="fas fa-search"></i> Tìm kiếm sản phẩm</div>
            <div class="input-group">
                <label for="searchText">Nhập đoạn văn bản mô tả sản phẩm</label>
                <textarea id="searchText" rows="3" placeholder="Ví dụ: Quần áo trẻ em chống nắng giày mũ nón bảo hiểm"></textarea>
            </div>
            
            <div class="input-group">
                <label for="processedText">Văn bản sau xử lý (không dấu, viết hoa)</label>
                <textarea id="processedText" rows="2" readonly></textarea>
            </div>
            
            <div class="buttons">
                <button class="search-btn" id="searchBtn">
                    <i class="fas fa-search"></i> Tìm kiếm
                </button>
                <button class="clear-btn" id="clearBtn">
                    <i class="fas fa-eraser"></i> Xoá
                </button>
            </div>
            
            <div class="input-group">
                <label for="searchResult">Kết quả tìm kiếm</label>
                <div class="result-box" id="searchResult">
                    <!-- Kết quả tìm kiếm sẽ hiển thị ở đây -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>

    <script>
        // Danh sách người
        const people = [
            {id: 1, name: "NGUYỄN KHẮC NĂNG", dob: "04/06/1944"},
            {id: 2, name: "TÔ THỊ HÀ", dob: "29/08/1948"},
            {id: 3, name: "NGUYỄN MINH NAM", dob: "03/03/1971"},
            {id: 4, name: "THÂN THỊ KIM ANH", dob: "23/09/1981"},
            {id: 5, name: "NGUYỄN TÔ NGÂN AN", dob: "28/09/2014"},
            {id: 6, name: "NGUYỄN TÔ MINH CHÂU", dob: "25/07/2016"},
            {id: 7, name: "NGUYỄN TÔ BÍCH NGỌC", dob: "05/02/2020"},
            {id: 8, name: "NGUYỄN THỊ MINH HẰNG", dob: "07/01/1974"},
            {id: 9, name: "NGÔ QUÝ CƯỜNG", dob: "23/05/1973"},
            {id: 10, name: "NGÔ GIA BÁCH", dob: "12/10/2000"},
            {id: 11, name: "NGÔ GIA LINH", dob: "05/04/2005"},
            {id: 12, name: "NGUYỄN THỊ MINH PHƯƠNG", dob: "06/11/1978"},
            {id: 13, name: "HOÀNG ANH DŨNG", dob: "21/09/1978"},
            {id: 14, name: "HOÀNG HẢI VINH", dob: "03/06/2010"},
            {id: 15, name: "HOÀNG THIÊN BẠCH ANH", dob: "14/11/2015"},
            {id: 16, name: "TÔ KIM HUỆ", dob: "09/08/1960"},
            {id: 17, name: "NGUYỄN TUẤN ANH", dob: "23/10/1983"},
            {id: 18, name: "NGUYỄN THẾ ANH", dob: "24/03/2001"},
            {id: 19, name: "NGÔ THỊ MAI", dob: "12/12/1948"},
            {id: 20, name: "TÔ VIỆT HƯNG", dob: "17/06/1996"},
            {id: 21, name: "TÔ THỊ HỒNG", dob: "10/10/1964"},
            {id: 22, name: "VŨ VĂN HIỆP", dob: "24/04/1974"},
            {id: 23, name: "NGUYỄN THỊ CHI", dob: "08/02/1946"},
            {id: 24, name: "NGUYỄN TẤN BẮC", dob: "30/11/1957"},
            {id: 25, name: "NGUYỄN THỊ TÂM", dob: "08/08/1954"}
        ];

        // Đề xuất mặt hàng theo độ tuổi
        const productSuggestionsByAge = {
            "child": ["Thời trang trẻ em", "Mẹ và Bé", "Phụ kiện thể thao", "Đồ chơi"],
            "teen": ["Thời trang trẻ em", "Phụ kiện thể thao", "Xu hướng", "Thời trang nam/nữ"],
            "young": ["Thời trang nam", "Thời trang nữ", "Xu hướng", "Phụ kiện thể thao", "Sắc đẹp"],
            "adult": ["Thời trang nam", "Thời trang nữ", "Nhà cửa & đời sống", "Sắc đẹp", "Xu hướng"],
            "middle": ["Nhà cửa & đời sống", "Thời trang nữ", "Thời trang nam", "Sắc đẹp", "Áo dài"],
            "senior": ["Nhà cửa & đời sống", "Áo dài", "Sức khỏe"]
        };

        // Khởi tạo ứng dụng
        document.addEventListener('DOMContentLoaded', function() {
            // Đặt ngày hiện tại mặc định
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('currentDate').value = formattedDate;
            
            // Hiển thị danh sách người
            renderPeopleList();
            
            // Gán sự kiện cho các nút
            document.getElementById('calculateBtn').addEventListener('click', calculate);
            document.getElementById('searchBtn').addEventListener('click', searchProducts);
            document.getElementById('clearBtn').addEventListener('click', clearSearch);
            
            // Gán sự kiện cho danh sách người
            document.getElementById('peopleList').addEventListener('click', handlePersonClick);
            
            // Hiển thị thông báo chào mừng
            showNotification("Chào mừng đến với ứng dụng tìm sản phẩm phù hợp!", "success");
        });

        // Hiển thị danh sách người
        function renderPeopleList() {
            const peopleList = document.getElementById('peopleList');
            peopleList.innerHTML = '';
            
            people.forEach(person => {
                const personElement = document.createElement('div');
                personElement.className = 'person-item';
                personElement.dataset.id = person.id;
                
                personElement.innerHTML = `
                    <div class="person-name">${person.name}</div>
                    <div class="person-dob">${person.dob}</div>
                `;
                
                peopleList.appendChild(personElement);
            });
        }

        // Xử lý khi chọn người từ danh sách
        function handlePersonClick(event) {
            const personItem = event.target.closest('.person-item');
            if (!personItem) return;
            
            // Xóa lớp selected từ tất cả
            document.querySelectorAll('.person-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Thêm lớp selected cho người được chọn
            personItem.classList.add('selected');
            
            // Lấy thông tin người
            const personId = parseInt(personItem.dataset.id);
            const person = people.find(p => p.id === personId);
            
            if (person) {
                // Cập nhật thông tin vào ô nhập liệu
                document.getElementById('personName').value = person.name;
                
                // Chuyển đổi định dạng ngày tháng
                const dobParts = person.dob.split('/');
                const formattedDob = `${dobParts[2]}-${dobParts[1].padStart(2, '0')}-${dobParts[0].padStart(2, '0')}`;
                document.getElementById('birthDate').value = formattedDob;
                
                showNotification(`Đã chọn: ${person.name}`, "success");
            }
        }

        // Tính toán các giá trị
        function calculate() {
            const currentDateInput = document.getElementById('currentDate').value;
            const birthDateInput = document.getElementById('birthDate').value;
            
            if (!currentDateInput) {
                showNotification("Vui lòng nhập ngày hiện tại", "error");
                return;
            }
            
            // Tính số ngày từ 1/1/1900 đến ngày hiện tại
            const currentDate = new Date(currentDateInput);
            const baseDate = new Date('1900-01-01');
            const diffTime = Math.abs(currentDate - baseDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            document.getElementById('diffDays').value = diffDays;
            
            // Tính mod 25
            const modResult = diffDays % 25;
            document.getElementById('modResult').value = modResult;
            
            // Tìm người theo kết quả mod (cộng thêm 1 vì danh sách bắt đầu từ 1)
            const personIndex = modResult === 0 ? 24 : modResult - 1;
            const foundPerson = people[personIndex];
            
            if (foundPerson) {
                document.getElementById('foundPerson').value = `${foundPerson.name} (${foundPerson.dob})`;
                
                // Lấy các chữ cái cuối cùng trong tên
                const nameParts = foundPerson.name.split(' ');
                const lastLetters = nameParts.map(part => part.charAt(part.length - 1)).join('');
                document.getElementById('lastLetters').value = lastLetters;
                
                // Tính tuổi
                const dobParts = foundPerson.dob.split('/');
                const birthYear = parseInt(dobParts[2]);
                const currentYear = currentDate.getFullYear();
                const age = currentYear - birthYear;
                document.getElementById('personAge').value = age;
                
                // Đề xuất mặt hàng theo tuổi
                let ageGroup = "";
                if (age <= 10) ageGroup = "child";
                else if (age <= 18) ageGroup = "teen";
                else if (age <= 30) ageGroup = "young";
                else if (age <= 45) ageGroup = "adult";
                else if (age <= 60) ageGroup = "middle";
                else ageGroup = "senior";
                
                const suggestions = productSuggestionsByAge[ageGroup] || [];
                const suggestionsHTML = suggestions.map(product => 
                    `<span class="product-category">${product}</span>`
                ).join('');
                
                document.getElementById('productSuggestions').innerHTML = suggestionsHTML;
                
                showNotification(`Đã tìm thấy: ${foundPerson.name}, ${age} tuổi`, "success");
            } else {
                showNotification("Không tìm thấy người phù hợp", "error");
            }
        }

        // Tìm kiếm sản phẩm
        function searchProducts() {
            const searchText = document.getElementById('searchText').value.trim();
            const lastLetters = document.getElementById('lastLetters').value;
            
            if (!searchText) {
                showNotification("Vui lòng nhập văn bản tìm kiếm", "error");
                return;
            }
            
            if (!lastLetters) {
                showNotification("Vui lòng tính toán trước để có chữ cái cuối tên", "error");
                return;
            }
            
            // Xử lý văn bản: bỏ dấu và viết hoa
            const processedText = removeAccents(searchText).toUpperCase();
            document.getElementById('processedText').value = processedText;
            
            // Tách văn bản thành các từ
            const words = processedText.split(' ');
            
            // Tìm các từ có chữ cái cuối trùng với các chữ cái cuối tên
            const lastLettersArray = lastLetters.split('');
            const foundWords = [];
            
            words.forEach(word => {
                if (word.length > 0) {
                    const lastChar = word.charAt(word.length - 1);
                    if (lastLettersArray.includes(lastChar)) {
                        foundWords.push({
                            word: word,
                            lastChar: lastChar
                        });
                    }
                }
            });
            
            // Hiển thị kết quả
            const searchResult = document.getElementById('searchResult');
            
            if (foundWords.length > 0) {
                let resultHTML = '';
                
                // Kiểm tra xem có đủ tất cả các chữ cái không
                const missingLetters = lastLettersArray.filter(letter => 
                    !foundWords.some(item => item.lastChar === letter)
                );
                
                if (missingLetters.length === 0) {
                    resultHTML += `<div class="result-item"><i class="fas fa-check-circle" style="color: #4CAF50;"></i> Tìm thấy tất cả chữ cái: <span class="highlight">${lastLetters}</span></div>`;
                } else {
                    resultHTML += `<div class="result-item"><i class="fas fa-exclamation-circle" style="color: #FF9800;"></i> Thiếu chữ cái: <span class="highlight">${missingLetters.join(', ')}</span></div>`;
                }
                
                resultHTML += '<div class="result-item">Các từ tìm được:</div>';
                
                foundWords.forEach(item => {
                    resultHTML += `<div class="result-item">"<span class="highlight">${item.word}</span>" (chữ cuối: <span class="highlight">${item.lastChar}</span>)</div>`;
                });
                
                // Tìm câu chứa các từ phù hợp
                const sentences = searchText.split(/[.!?]/).filter(s => s.trim().length > 0);
                const matchingSentences = [];
                
                sentences.forEach(sentence => {
                    const sentenceWithoutAccents = removeAccents(sentence).toUpperCase();
                    const sentenceWords = sentenceWithoutAccents.split(' ');
                    
                    let matchCount = 0;
                    lastLettersArray.forEach(letter => {
                        const hasLetter = sentenceWords.some(word => 
                            word.length > 0 && word.charAt(word.length - 1) === letter
                        );
                        if (hasLetter) matchCount++;
                    });
                    
                    if (matchCount > 0) {
                        matchingSentences.push({
                            sentence: sentence.trim(),
                            matchCount: matchCount
                        });
                    }
                });
                
                // Sắp xếp câu theo số chữ cái khớp
                matchingSentences.sort((a, b) => b.matchCount - a.matchCount);
                
                if (matchingSentences.length > 0) {
                    resultHTML += '<div class="result-item">Câu có chứa chữ cái phù hợp:</div>';
                    matchingSentences.slice(0, 3).forEach((item, index) => {
                        resultHTML += `<div class="result-item">${index + 1}. "${item.sentence}" (khớp ${item.matchCount}/${lastLettersArray.length} chữ cái)</div>`;
                    });
                }
                
                searchResult.innerHTML = resultHTML;
                
                if (missingLetters.length === 0) {
                    showNotification("Tìm thấy đầy đủ chữ cái trong văn bản!", "success");
                } else {
                    showNotification(`Tìm thấy ${foundWords.length} từ phù hợp`, "success");
                }
            } else {
                searchResult.innerHTML = '<div class="result-item"><i class="fas fa-times-circle" style="color: #f44336;"></i> Không tìm thấy từ nào có chữ cái cuối trùng khớp</div>';
                showNotification("Không tìm thấy từ phù hợp", "error");
            }
        }

        // Hàm bỏ dấu tiếng Việt
        function removeAccents(str) {
            return str.normalize('NFD')
                      .replace(/[\u0300-\u036f]/g, '')
                      .replace(/đ/g, 'd').replace(/Đ/g, 'D');
        }

        // Xóa nội dung tìm kiếm
        function clearSearch() {
            document.getElementById('searchText').value = '';
            document.getElementById('processedText').value = '';
            document.getElementById('searchResult').innerHTML = '';
            showNotification("Đã xóa nội dung tìm kiếm", "success");
        }

        // Hiển thị thông báo
        function showNotification(message, type = "success") {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification';
            
            if (type === "error") {
                notification.classList.add('error');
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>