<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng C·ª• Chuy·ªÉn ƒê·ªïi D∆∞∆°ng L·ªãch - √Çm L·ªãch</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 800px;
            padding: 30px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #6a11cb, #2575fc);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .input-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .input-group {
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 1.1rem;
        }

        input[type="date"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input[type="date"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .date-range {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        button {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        #convertBtn {
            background: linear-gradient(90deg, #3498db, #2980b9);
            color: white;
        }

        #convertBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        #todayBtn {
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            color: white;
        }

        #todayBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }

        .results {
            margin-top: 30px;
            display: none;
        }

        .result-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid;
            transition: transform 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-5px);
        }

        .solar-card {
            border-left-color: #3498db;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        }

        .lunar-card {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
        }

        .result-title {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .date-display {
            font-size: 2.5rem;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
        }

        .solar-date {
            color: #2980b9;
        }

        .lunar-date {
            color: #c0392b;
        }

        .date-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .detail-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
        }

        .detail-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
        }

        .year-detail {
            color: #e74c3c;
        }

        .month-detail {
            color: #3498db;
        }

        .day-detail {
            color: #27ae60;
        }

        .weekday-display {
            background: linear-gradient(135deg, #fff3e0, #ffecb3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin-top: 15px;
            border: 2px solid #ffb300;
        }

        .weekday-label {
            font-size: 1rem;
            color: #ff8f00;
            margin-bottom: 5px;
        }

        .weekday-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #f57c00;
        }

        .info-box {
            background: #e8f4fd;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #3498db;
        }

        .info-box p {
            color: #2c3e50;
            line-height: 1.6;
        }

        .info-icon {
            color: #3498db;
            margin-right: 10px;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .date-details {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .date-display {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåì Chuy·ªÉn ƒê·ªïi D∆∞∆°ng L·ªãch - √Çm L·ªãch</h1>
            <p class="subtitle">C√¥ng c·ª• chuy·ªÉn ƒë·ªïi ng√†y d∆∞∆°ng l·ªãch sang √¢m l·ªãch - Ho·∫°t ƒë·ªông offline</p>
        </header>

        <div class="input-section">
            <div class="input-group">
                <label for="solarDate">üìÖ Ch·ªçn ng√†y d∆∞∆°ng l·ªãch:</label>
                <input type="date" id="solarDate" min="1900-01-01" max="2100-12-31">
                <div class="date-range">Ph·∫°m vi: 01/01/1900 - 31/12/2100</div>
            </div>
        </div>

        <div class="button-group">
            <button id="convertBtn" onclick="convertDate()">
                üîÑ Chuy·ªÉn ƒê·ªïi
            </button>
            <button id="todayBtn" onclick="setToday()">
                üìÖ H√¥m Nay
            </button>
        </div>

        <div class="results" id="results">
            <div class="result-card solar-card">
                <div class="result-title">
                    ‚òÄÔ∏è Ng√†y D∆∞∆°ng L·ªãch
                </div>
                <div class="date-display solar-date" id="solarDisplay"></div>
                
                <div class="date-details">
                    <div class="detail-item">
                        <div class="detail-label">NƒÉm</div>
                        <div class="detail-value year-detail" id="solarYear"></div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Th√°ng</div>
                        <div class="detail-value month-detail" id="solarMonth"></div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Ng√†y</div>
                        <div class="detail-value day-detail" id="solarDay"></div>
                    </div>
                </div>
            </div>

            <div class="result-card lunar-card">
                <div class="result-title">
                    üåô Ng√†y √Çm L·ªãch
                </div>
                <div class="date-display lunar-date" id="lunarDisplay"></div>
                
                <div class="date-details">
                    <div class="detail-item">
                        <div class="detail-label">NƒÉm</div>
                        <div class="detail-value year-detail" id="lunarYear"></div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Th√°ng</div>
                        <div class="detail-value month-detail" id="lunarMonth"></div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Ng√†y</div>
                        <div class="detail-value day-detail" id="lunarDay"></div>
                    </div>
                </div>

                <div class="weekday-display" id="weekdayDisplay">
                    <div class="weekday-label">üìÜ Th·ª© trong tu·∫ßn</div>
                    <div class="weekday-value" id="weekdayValue"></div>
                </div>
            </div>

            <div class="info-box">
                <p>üí° <strong>L∆∞u √Ω:</strong> C√¥ng c·ª• n√†y s·ª≠ d·ª•ng thu·∫≠t to√°n chuy·ªÉn ƒë·ªïi d∆∞∆°ng l·ªãch sang √¢m l·ªãch. 
                K·∫øt qu·∫£ c√≥ th·ªÉ c√≥ sai s·ªë nh·ªè so v·ªõi l·ªãch ch√≠nh th·ª©c. ·ª®ng d·ª•ng ho·∫°t ƒë·ªông ho√†n to√†n offline.</p>
            </div>
        </div>

        <footer>
            <p>¬© 2024 C√¥ng C·ª• Chuy·ªÉn ƒê·ªïi D∆∞∆°ng L·ªãch - √Çm L·ªãch | Ho·∫°t ƒë·ªông offline</p>
            <p>Thu·∫≠t to√°n d·ª±a tr√™n c√¥ng th·ª©c t√≠nh l·ªãch √¢m truy·ªÅn th·ªëng</p>
        </footer>
    </div>

    <script>
        // ========== H√ÄM CHUY·ªÇN ƒê·ªîI C∆† B·∫¢N ==========
        function jdFromDate(dd, mm, yy) {
            if (mm <= 2) {
                yy--;
                mm += 12;
            }
            let A = Math.floor(yy / 100);
            let B = 2 - A + Math.floor(A / 4);
            return Math.floor(365.25 * (yy + 4716)) + Math.floor(30.6001 * (mm + 1)) + dd + B - 1524;
        }

        // ========== THU·∫¨T TO√ÅN √ÇM L·ªäCH ==========
        const PI = Math.PI;

        function NewMoon(k) {
            let T = k / 1236.85;
            let T2 = T * T;
            let T3 = T2 * T;
            let dr = PI / 180;
            
            let Jd1 = 2415020.75933 + 29.53058868 * k + 0.0001178 * T2 - 0.000000155 * T3;
            Jd1 = Jd1 + 0.00033 * Math.sin((166.56 + 132.87 * T - 0.009173 * T2) * dr);
            
            let M = 359.2242 + 29.10535608 * k - 0.0000333 * T2 - 0.00000347 * T3;
            let Mpr = 306.0253 + 385.81691806 * k + 0.0107306 * T2 + 0.00001236 * T3;
            let F = 21.2964 + 390.67050646 * k - 0.0016528 * T2 - 0.00000239 * T3;
            
            let C1 = (0.1734 - 0.000393 * T) * Math.sin(M * dr);
            C1 = C1 + 0.0021 * Math.sin(2 * dr * M);
            C1 = C1 - 0.4068 * Math.sin(Mpr * dr);
            C1 = C1 + 0.0161 * Math.sin(2 * dr * Mpr);
            C1 = C1 - 0.0004 * Math.sin(3 * dr * Mpr);
            C1 = C1 + 0.0104 * Math.sin(2 * dr * F);
            C1 = C1 - 0.0051 * Math.sin(dr * (M + Mpr));
            C1 = C1 - 0.0074 * Math.sin(dr * (M - Mpr));
            C1 = C1 + 0.0004 * Math.sin(dr * (2 * F + M));
            C1 = C1 - 0.0004 * Math.sin(dr * (2 * F - M));
            C1 = C1 - 0.0006 * Math.sin(dr * (2 * F + Mpr));
            C1 = C1 + 0.0010 * Math.sin(dr * (2 * F - Mpr));
            C1 = C1 + 0.0005 * Math.sin(dr * (2 * Mpr + M));
            
            let deltaT;
            if (T < -11) {
                deltaT = 0.001 + 0.000839 * T + 0.0002261 * T2 - 0.00000845 * T3 - 0.000000081 * T * T3;
            } else {
                deltaT = -0.000278 + 0.000265 * T + 0.000262 * T2;
            }
            
            return Jd1 + C1 - deltaT;
        }

        function getNewMoonDay(k, timeZone) {
            return Math.floor(NewMoon(k) + 0.5 + timeZone / 24);
        }

        function getSunLongitude(jdn, timeZone) {
            let T = (jdn - 2451545.5 - timeZone / 24) / 36525;
            let M = 357.52910 + 35999.05030 * T - 0.0001559 * T * T - 0.00000048 * T * T * T;
            let L0 = 280.46645 + 36000.76983 * T + 0.0003032 * T * T;
            let DL = (1.914600 - 0.004817 * T - 0.000014 * T * T) * Math.sin(M * PI / 180);
            DL = DL + (0.019993 - 0.000101 * T) * Math.sin(2 * M * PI / 180) + 0.000290 * Math.sin(3 * M * PI / 180);
            let L = (L0 + DL) * PI / 180;
            L = L - 2 * PI * Math.floor(L / (2 * PI));
            return Math.floor(L / (PI / 6));
        }

        function getLunarMonth11(yy, timeZone) {
            let off = jdFromDate(31, 12, yy) - 2415021;
            let k = Math.floor(off / 29.530588853);
            let nm = getNewMoonDay(k, timeZone);
            let sunLong = getSunLongitude(nm, timeZone);
            
            if (sunLong >= 9) {
                nm = getNewMoonDay(k - 1, timeZone);
            }
            return nm;
        }

        function getLeapMonthOffset(a11, timeZone) {
            let k = Math.floor((a11 - 2415021) / 29.530588853);
            let last;
            let i = 1;
            let arc = getSunLongitude(getNewMoonDay(k + i, timeZone), timeZone);
            
            do {
                last = arc;
                i++;
                arc = getSunLongitude(getNewMoonDay(k + i, timeZone), timeZone);
            } while (arc != last && i < 14);
            
            return i - 1;
        }

        // ========== H√ÄM CH√çNH CHUY·ªÇN ƒê·ªîI ==========
        function solarToLunar(dd, mm, yy, timeZone) {
            let dayNumber = jdFromDate(dd, mm, yy);
            let k = Math.floor((dayNumber - 2415021) / 29.530588853);
            let monthStart = getNewMoonDay(k + 1, timeZone);
            
            if (monthStart > dayNumber) {
                monthStart = getNewMoonDay(k, timeZone);
            }
            
            let a11 = getLunarMonth11(yy, timeZone);
            let b11 = a11;
            
            let lunarYear;
            if (a11 >= monthStart) {
                lunarYear = yy;
                a11 = getLunarMonth11(yy - 1, timeZone);
            } else {
                lunarYear = yy + 1;
                b11 = getLunarMonth11(yy + 1, timeZone);
            }
            
            let lunarDay = dayNumber - monthStart + 1;
            let diff = Math.floor((monthStart - a11) / 29);
            let lunarLeap = 0;
            let lunarMonth = diff + 11;
            
            if (b11 - a11 > 365) {
                let leapMonthDiff = getLeapMonthOffset(a11, timeZone);
                if (diff >= leapMonthDiff) {
                    lunarMonth = diff + 10;
                    if (diff == leapMonthDiff) {
                        lunarLeap = 1;
                    }
                }
            }
            
            if (lunarMonth > 12) {
                lunarMonth = lunarMonth - 12;
            }
            
            if (lunarMonth >= 11 && diff < 4) {
                lunarYear = lunarYear - 1;
            }
            
            return {
                day: lunarDay,
                month: lunarMonth,
                year: lunarYear,
                leap: lunarLeap
            };
        }

        // ========== H√ÄM HI·ªÇN TH·ªä K·∫æT QU·∫¢ ==========
        function formatLunarMonth(month, isLeap) {
            const monthNames = [
                "M·ªôt", "Hai", "Ba", "T∆∞", "NƒÉm", "S√°u", 
                "B·∫£y", "T√°m", "Ch√≠n", "M∆∞·ªùi", "M∆∞·ªùi M·ªôt", "Ch·∫°p"
            ];
            
            let monthName = monthNames[month - 1];
            if (isLeap) {
                return `Th√°ng ${monthName} (Nhu·∫≠n)`;
            }
            return `Th√°ng ${monthName}`;
        }

        function formatDate(y, m, d, type) {
            if (type === 'solar') {
                return `Ng√†y ${d} th√°ng ${m} nƒÉm ${y}`;
            } else {
                return `Ng√†y ${d} th√°ng ${m} nƒÉm ${y}`;
            }
        }

        function getWeekday(y, m, d) {
            const weekdays = [
                "Ch·ªß Nh·∫≠t", "Th·ª© Hai", "Th·ª© Ba", "Th·ª© T∆∞", 
                "Th·ª© NƒÉm", "Th·ª© S√°u", "Th·ª© B·∫£y"
            ];
            
            // S·ª≠a l·ªói th√°ng (0-11 trong JavaScript)
            let date = new Date(y, m - 1, d);
            return weekdays[date.getDay()];
        }

        // ========== H√ÄM X·ª¨ L√ù GIAO DI·ªÜN ==========
        function convertDate() {
            let dateValue = document.getElementById('solarDate').value;
            if (!dateValue) {
                alert('Vui l√≤ng ch·ªçn ng√†y d∆∞∆°ng l·ªãch!');
                return;
            }
            
            let [y, m, d] = dateValue.split('-').map(Number);
            
            // Ki·ªÉm tra ng√†y h·ª£p l·ªá
            let inputDate = new Date(y, m - 1, d);
            if (inputDate.getFullYear() !== y || inputDate.getMonth() !== m - 1 || inputDate.getDate() !== d) {
                alert('Ng√†y kh√¥ng h·ª£p l·ªá! Vui l√≤ng ch·ªçn ng√†y kh√°c.');
                return;
            }
            
            // Chuy·ªÉn ƒë·ªïi sang √¢m l·ªãch
            let timeZone = 7; // UTC+7 (Vi·ªát Nam)
            let lunar = solarToLunar(d, m, y, timeZone);
            
            // C·∫≠p nh·∫≠t th√¥ng tin d∆∞∆°ng l·ªãch
            document.getElementById('solarDisplay').textContent = formatDate(y, m, d, 'solar');
            document.getElementById('solarYear').textContent = y;
            document.getElementById('solarMonth').textContent = m;
            document.getElementById('solarDay').textContent = d;
            
            // C·∫≠p nh·∫≠t th√¥ng tin √¢m l·ªãch
            let lunarMonthDisplay = formatLunarMonth(lunar.month, lunar.leap);
            document.getElementById('lunarDisplay').textContent = 
                `Ng√†y ${lunar.day} ${lunarMonthDisplay.toLowerCase()} nƒÉm ${lunar.year}`;
            document.getElementById('lunarYear').textContent = lunar.year;
            document.getElementById('lunarMonth').textContent = lunar.month + (lunar.leap ? " (Nhu·∫≠n)" : "");
            document.getElementById('lunarDay').textContent = lunar.day;
            
            // C·∫≠p nh·∫≠t th·ª© trong tu·∫ßn
            let weekday = getWeekday(y, m, d);
            document.getElementById('weekdayValue').textContent = weekday;
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            document.getElementById('results').style.display = 'block';
            
            // Cu·ªôn ƒë·∫øn k·∫øt qu·∫£
            document.getElementById('results').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
        }

        function setToday() {
            let today = new Date();
            let yyyy = today.getFullYear();
            let mm = String(today.getMonth() + 1).padStart(2, '0');
            let dd = String(today.getDate()).padStart(2, '0');
            
            document.getElementById('solarDate').value = `${yyyy}-${mm}-${dd}`;
            convertDate();
        }

        // ========== KH·ªûI T·∫†O TRANG ==========
        window.onload = function() {
            // ƒê·∫∑t ng√†y m·∫∑c ƒë·ªãnh l√† h√¥m nay
            setToday();
            
            // Th√™m s·ª± ki·ªán Enter ƒë·ªÉ chuy·ªÉn ƒë·ªïi
            document.getElementById('solarDate').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    convertDate();
                }
            });
        };
    </script>
</body>
</html>