<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Công cụ Tra cứu 24 Tiết Khí & Sức Khỏe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --spring-color: #2ecc71;
            --summer-color: #e74c3c;
            --autumn-color: #f39c12;
            --winter-color: #3498db;
            --light-color: #f8f9fa;
            --dark-color: #2c3e50;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            padding-bottom: 50px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            margin-bottom: 20px;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .card-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--secondary-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .current-date {
            font-size: 1.2rem;
            text-align: center;
            padding: 15px;
            background-color: #e8f4fc;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .current-date span {
            font-weight: bold;
            color: var(--secondary-color);
        }

        .season-tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .spring { background-color: rgba(46, 204, 113, 0.2); color: var(--spring-color); }
        .summer { background-color: rgba(231, 76, 60, 0.2); color: var(--summer-color); }
        .autumn { background-color: rgba(243, 156, 18, 0.2); color: var(--autumn-color); }
        .winter { background-color: rgba(52, 152, 219, 0.2); color: var(--winter-color); }

        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
        }

        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .results-section {
            margin-top: 40px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
        }

        .coming-soon {
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .coming-soon-title {
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .next-solar-term {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .term-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .term-date {
            font-size: 1.2rem;
            color: #7f8c8d;
        }

        .days-left {
            background-color: var(--secondary-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }

        .solar-terms-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .solar-terms-table th, .solar-terms-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .solar-terms-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--primary-color);
            position: sticky;
            top: 0;
        }

        .solar-terms-table tr:hover {
            background-color: #f8f9fa;
            cursor: pointer;
        }

        .season-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .countdown {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: var(--secondary-color);
        }

        .term-detail {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .term-detail h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .term-detail p {
            margin-bottom: 10px;
        }

        .info-text {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-top: 10px;
            font-style: italic;
        }

        .health-section {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 40px;
        }

        .health-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .health-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .symptom-badge {
            display: inline-block;
            background-color: #e74c3c;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            margin: 2px;
        }

        .food-badge {
            display: inline-block;
            background-color: #2ecc71;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            margin: 2px;
        }

        .disease-list {
            list-style-type: none;
            padding-left: 0;
        }

        .disease-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .disease-list li:last-child {
            border-bottom: none;
        }

        .tab-container {
            margin-top: 30px;
        }

        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            transition: var(--transition);
        }

        .tab-btn:hover {
            color: var(--secondary-color);
        }

        .tab-btn.active {
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .control-panel {
                grid-template-columns: 1fr;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .solar-terms-table {
                display: block;
                overflow-x: auto;
            }
            
            .tab-buttons {
                flex-wrap: wrap;
            }
            
            .tab-btn {
                flex: 1;
                min-width: 120px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-calendar-alt"></i> Công cụ Tra cứu 24 Tiết Khí & Sức Khỏe</h1>
            <p class="subtitle">Tra cứu tiết khí, bệnh thường gặp và món ăn phòng tránh theo từng mùa</p>
        </header>

        <div class="control-panel">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-calendar-day"></i> Ngày hiện tại
                </div>
                
                <div class="current-date">
                    Hôm nay là: <span id="currentDate"></span>
                </div>
                
                <div class="form-group">
                    <label for="yearSelect">Chọn năm cần tra cứu:</label>
                    <select id="yearSelect">
                        <!-- Năm sẽ được thêm bằng JavaScript -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="termSelect">Chọn tiết khí cần xem:</label>
                    <select id="termSelect">
                        <!-- Tiết khí sẽ được thêm bằng JavaScript -->
                    </select>
                </div>
                
                <button class="btn" id="searchBtn">
                    <i class="fas fa-search"></i> Tra cứu Tiết Khí
                </button>
            </div>
            
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-clock"></i> Tiết khí sắp tới
                </div>
                
                <div id="nextTermInfo">
                    <!-- Thông tin tiết khí sắp tới sẽ hiển thị ở đây -->
                    <p>Đang tải thông tin...</p>
                </div>
                
                <div class="countdown" id="countdown">
                    -- ngày --:--:--
                </div>
                
                <div class="info-text">
                    <i class="fas fa-info-circle"></i> Thời gian còn lại cho đến tiết khí tiếp theo
                </div>
            </div>
        </div>
        
        <div class="coming-soon">
            <div class="coming-soon-title">Tiết khí sắp diễn ra</div>
            <div id="nextTermDisplay">
                <!-- Hiển thị tiết khí sắp tới -->
            </div>
        </div>
        
        <!-- Tab Container -->
        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="solar-terms">24 Tiết Khí</button>
                <button class="tab-btn" data-tab="health-info">Bệnh & Món Ăn</button>
                <button class="tab-btn" data-tab="personal-health">Sức Khỏe Cá Nhân</button>
            </div>
            
            <!-- Tab 1: 24 Tiết Khí -->
            <div class="tab-content active" id="solar-terms">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-list"></i> 24 Tiết Khí Năm <span id="selectedYear"></span>
                    </div>
                    
                    <table class="solar-terms-table" id="solarTermsTable">
                        <thead>
                            <tr>
                                <th>Tiết Khí</th>
                                <th>Bắt đầu</th>
                                <th>Kết thúc</th>
                                <th>Độ (từ Xuân phân)</th>
                                <th>Mùa</th>
                                <th>Bệnh thường gặp</th>
                            </tr>
                        </thead>
                        <tbody id="solarTermsBody">
                            <!-- Dữ liệu tiết khí sẽ được thêm ở đây -->
                        </tbody>
                    </table>
                    
                    <div class="info-text">
                        <i class="fas fa-info-circle"></i> Dữ liệu tiết khí được tính toán dựa trên năm đã chọn
                    </div>
                </div>
                
                <div class="term-detail" id="termDetail">
                    <h3>Thông tin chi tiết về tiết khí</h3>
                    <p>Chọn một tiết khí để xem thông tin chi tiết.</p>
                </div>
            </div>
            
            <!-- Tab 2: Bệnh & Món Ăn -->
            <div class="tab-content" id="health-info">
                <div class="health-section">
                    <div class="card">
                        <div class="card-title">
                            <i class="fas fa-heartbeat"></i> Bệnh thường gặp và món ăn phòng tránh theo mùa
                        </div>
                        
                        <div class="health-grid">
                            <div class="health-card">
                                <h4><span class="season-tag spring">Mùa Xuân</span></h4>
                                <p><strong>Bệnh thường gặp:</strong></p>
                                <ul class="disease-list">
                                    <li>Cảm cúm, viêm đường hô hấp</li>
                                    <li>Dị ứng phấn hoa</li>
                                    <li>Viêm mũi dị ứng</li>
                                    <li>Các bệnh về da</li>
                                </ul>
                                <p><strong>Món ăn phòng tránh:</strong></p>
                                <div>
                                    <span class="food-badge">Canh gà hầm thuốc bắc</span>
                                    <span class="food-badge">Cháo hành tía tô</span>
                                    <span class="food-badge">Trà gừng mật ong</span>
                                </div>
                            </div>
                            
                            <div class="health-card">
                                <h4><span class="season-tag summer">Mùa Hạ</span></h4>
                                <p><strong>Bệnh thường gặp:</strong></p>
                                <ul class="disease-list">
                                    <li>Say nắng, say nóng</li>
                                    <li>Rối loạn tiêu hóa</li>
                                    <li>Các bệnh về da do nắng</li>
                                    <li>Viêm đường tiết niệu</li>
                                </ul>
                                <p><strong>Món ăn phòng tránh:</strong></p>
                                <div>
                                    <span class="food-badge">Chè đậu đen</span>
                                    <span class="food-badge">Nước rau má</span>
                                    <span class="food-badge">Canh bí đao</span>
                                </div>
                            </div>
                            
                            <div class="health-card">
                                <h4><span class="season-tag autumn">Mùa Thu</span></h4>
                                <p><strong>Bệnh thường gặp:</strong></p>
                                <ul class="disease-list">
                                    <li>Viêm họng, viêm phế quản</li>
                                    <li>Khô da, nứt nẻ</li>
                                    <li>Đau nhức xương khớp</li>
                                    <li>Cảm lạnh</li>
                                </ul>
                                <p><strong>Món ăn phòng tránh:</strong></p>
                                <div>
                                    <span class="food-badge">Cháo hành tía tô</span>
                                    <span class="food-badge">Canh bí đỏ</span>
                                    <span class="food-badge">Trà hoa cúc</span>
                                </div>
                            </div>
                            
                            <div class="health-card">
                                <h4><span class="season-tag winter">Mùa Đông</span></h4>
                                <p><strong>Bệnh thường gặp:</strong></p>
                                <ul class="disease-list">
                                    <li>Cảm lạnh, viêm phổi</li>
                                    <li>Đau nhức xương khớp</li>
                                    <li>Tim mạch, huyết áp</li>
                                    <li>Khô nẻ da</li>
                                </ul>
                                <p><strong>Món ăn phòng tránh:</strong></p>
                                <div>
                                    <span class="food-badge">Cháo hành tía tô</span>
                                    <span class="food-badge">Gà hầm thuốc bắc</span>
                                    <span class="food-badge">Trà gừng</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab 3: Sức Khỏe Cá Nhân -->
            <div class="tab-content" id="personal-health">
                <div class="health-section">
                    <div class="card">
                        <div class="card-title">
                            <i class="fas fa-user-md"></i> Theo dõi sức khỏe cá nhân
                        </div>
                        
                        <div class="form-group">
                            <label for="birthDate"><i class="fas fa-birthday-cake"></i> Ngày tháng năm sinh:</label>
                            <input type="date" id="birthDate" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="personSelect"><i class="fas fa-user-circle"></i> Danh sách người (chọn để tự động nhập):</label>
                            <select id="personSelect" class="form-control">
                                <option value="">-- Chọn một người --</option>
                                <option value="25993">NAM (Ngày sinh: 01/01/1970)</option>
                                <option value="29850">KA (Ngày sinh: 15/08/1990)</option>
                                <option value="41529">NA (Ngày sinh: 14/09/2013)</option>
                                <option value="17772">BA HA (Ngày sinh: 13/03/1971)</option>
                                <option value="16680">PHO (Ngày sinh: 20/05/1975)</option>
                            </select>
                        </div>
                        
                        <button class="btn" id="healthAnalysisBtn">
                            <i class="fas fa-stethoscope"></i> Phân tích sức khỏe
                        </button>
                        
                        <div id="healthResults" style="display: none; margin-top: 20px;">
                            <div class="card">
                                <div class="card-title">
                                    <i class="fas fa-chart-line"></i> Kết quả phân tích
                                </div>
                                <div id="healthAnalysisResults">
                                    <!-- Kết quả phân tích sức khỏe sẽ hiển thị ở đây -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dữ liệu 24 tiết khí cơ bản với thông tin bệnh
        const solarTermsData = [
            { name: "LẬP XUÂN", startDay: 4, startMonth: 2, endDay: 5, endMonth: 2, degree: 315, season: "spring", duration: 15, 
              description: "Bắt đầu mùa xuân, thời tiết ấm dần lên.", 
              diseases: ["Cảm cúm", "Viêm đường hô hấp", "Dị ứng"], 
              foods: ["Canh gà hầm thuốc bắc", "Cháo hành tía tô", "Trà gừng mật ong"] },
            { name: "VŨ THỦY", startDay: 19, startMonth: 2, endDay: 20, endMonth: 2, degree: 330, season: "spring", duration: 15, 
              description: "Mưa xuân bắt đầu, độ ẩm tăng.", 
              diseases: ["Viêm mũi dị ứng", "Cảm lạnh", "Đau nhức xương khớp"], 
              foods: ["Cháo gà", "Canh nấm", "Trà hoa cúc"] },
            { name: "KINH TRẬP", startDay: 6, startMonth: 3, endDay: 7, endMonth: 3, degree: 345, season: "spring", duration: 15, 
              description: "Sâu bọ thức dậy sau mùa đông.", 
              diseases: ["Dị ứng da", "Viêm kết mạc", "Rối loạn tiêu hóa"], 
              foods: ["Rau sống", "Nước chanh", "Sữa chua"] },
            { name: "XUÂN PHÂN", startDay: 21, startMonth: 3, endDay: 22, endMonth: 3, degree: 0, season: "spring", duration: 15, 
              description: "Ngày và đêm dài bằng nhau.", 
              diseases: ["Rối loạn giấc ngủ", "Đau đầu", "Mệt mỏi"], 
              foods: ["Cháo yến mạch", "Hoa quả tươi", "Trà tâm sen"] },
            { name: "THANH MINH", startDay: 5, startMonth: 4, endDay: 6, endMonth: 4, degree: 15, season: "spring", duration: 15, 
              description: "Trời trong sáng, thích hợp tảo mộ.", 
              diseases: ["Viêm phế quản", "Hen suyễn", "Dị ứng phấn hoa"], 
              foods: ["Bánh trôi nước", "Xôi ngũ sắc", "Nước mơ"] },
            { name: "CỐC VŨ", startDay: 20, startMonth: 4, endDay: 21, endMonth: 4, degree: 30, season: "spring", duration: 15, 
              description: "Mưa rào cuối xuân, tốt cho lúa.", 
              diseases: ["Cảm mạo", "Viêm họng", "Rối loạn tiêu hóa"], 
              foods: ["Cháo đậu xanh", "Canh rau ngót", "Trà gừng"] },
            { name: "LẬP HẠ", startDay: 6, startMonth: 5, endDay: 7, endMonth: 5, degree: 45, season: "summer", duration: 15, 
              description: "Bắt đầu mùa hè, thời tiết nóng dần.", 
              diseases: ["Say nắng", "Rối loạn tiêu hóa", "Viêm da"], 
              foods: ["Chè đậu đen", "Nước rau má", "Canh bí đao"] },
            { name: "TIỂU MÃN", startDay: 21, startMonth: 5, endDay: 22, endMonth: 5, degree: 60, season: "summer", duration: 15, 
              description: "Lúa bắt đầu chín, trời nắng nhiều.", 
              diseases: ["Mất nước", "Say nóng", "Viêm đường tiết niệu"], 
              foods: ["Nước dừa", "Sinh tố hoa quả", "Chè hạt sen"] },
            { name: "MANG CHỦNG", startDay: 6, startMonth: 6, endDay: 7, endMonth: 6, degree: 75, season: "summer", duration: 15, 
              description: "Thời gian gieo trồng vụ mùa.", 
              diseases: ["Sốt xuất huyết", "Tiêu chảy", "Viêm gan"], 
              foods: ["Cháo trai", "Canh chua", "Nước sắn dây"] },
            { name: "HẠ CHÍ", startDay: 21, startMonth: 6, endDay: 22, endMonth: 6, degree: 90, season: "summer", duration: 15, 
              description: "Ngày dài nhất trong năm.", 
              diseases: ["Đột quỵ do nóng", "Kiệt sức", "Cháy nắng"], 
              foods: ["Nước mía", "Chè đỗ đen", "Sữa chua"] },
            { name: "TIỂU THỬ", startDay: 7, startMonth: 7, endDay: 8, endMonth: 7, degree: 105, season: "summer", duration: 15, 
              description: "Thời tiết nóng bức, oi ả.", 
              diseases: ["Cảm nắng", "Mất ngủ", "Chán ăn"], 
              foods: ["Canh khổ qua", "Nước atiso", "Chè bắp"] },
            { name: "ĐẠI THỬ", startDay: 22, startMonth: 7, endDay: 23, endMonth: 7, degree: 120, season: "summer", duration: 15, 
              description: "Nóng nhất trong năm.", 
              diseases: ["Sốc nhiệt", "Ngộ độc thực phẩm", "Viêm da mủ"], 
              foods: ["Nước chanh", "Cháo hạt sen", "Canh cua"] },
            { name: "LẬP THU", startDay: 8, startMonth: 8, endDay: 9, endMonth: 8, degree: 135, season: "autumn", duration: 15, 
              description: "Bắt đầu mùa thu, trời mát dần.", 
              diseases: ["Cảm lạnh", "Viêm họng", "Khô da"], 
              foods: ["Cháo gà", "Canh bí đỏ", "Trà hoa cúc"] },
            { name: "XỬ THỬ", startDay: 23, startMonth: 8, endDay: 24, endMonth: 8, degree: 150, season: "autumn", duration: 15, 
              description: "Nắng nóng cuối hè giảm dần.", 
              diseases: ["Viêm phế quản", "Dị ứng thời tiết", "Đau nhức xương"], 
              foods: ["Cháo hành", "Canh măng", "Trà gừng"] },
            { name: "BẠCH LỘ", startDay: 8, startMonth: 9, endDay: 9, endMonth: 9, degree: 165, season: "autumn", duration: 15, 
              description: "Sương mù bắt đầu xuất hiện.", 
              diseases: ["Viêm mũi dị ứng", "Ho khan", "Viêm da cơ địa"], 
              foods: ["Cháo táo đỏ", "Canh nấm", "Trà cam thảo"] },
            { name: "THU PHÂN", startDay: 23, startMonth: 9, endDay: 24, endMonth: 9, degree: 180, season: "autumn", duration: 15, 
              description: "Ngày và đêm dài bằng nhau.", 
              diseases: ["Trầm cảm mùa thu", "Rối loạn giấc ngủ", "Đau dạ dày"], 
              foods: ["Cháo hạt sen", "Canh bí đỏ", "Trà tâm sen"] },
            { name: "HÀN LỘ", startDay: 8, startMonth: 10, endDay: 9, endMonth: 10, degree: 195, season: "autumn", duration: 15, 
              description: "Sương lạnh bắt đầu xuất hiện.", 
              diseases: ["Cảm lạnh", "Viêm xoang", "Đau khớp"], 
              foods: ["Cháo thịt bằm", "Canh cá", "Trà gừng mật ong"] },
            { name: "SƯƠNG GIÁNG", startDay: 23, startMonth: 10, endDay: 24, endMonth: 10, degree: 210, season: "autumn", duration: 15, 
              description: "Sương giá xuất hiện nhiều.", 
              diseases: ["Viêm phổi", "Hen suyễn", "Viêm khớp dạng thấp"], 
              foods: ["Cháo gà hầm thuốc bắc", "Canh hầm xương", "Trà quế"] },
            { name: "LẬP ĐÔNG", startDay: 7, startMonth: 11, endDay: 8, endMonth: 11, degree: 225, season: "winter", duration: 15, 
              description: "Bắt đầu mùa đông.", 
              diseases: ["Cảm lạnh", "Viêm phổi", "Đau nhức xương khớp"], 
              foods: ["Cháo hành tía tô", "Gà hầm thuốc bắc", "Trà gừng"] },
            { name: "TIỂU TUYẾT", startDay: 22, startMonth: 11, endDay: 23, endMonth: 11, degree: 240, season: "winter", duration: 15, 
              description: "Tuyết bắt đầu rơi ít.", 
              diseases: ["Huyết áp cao", "Tai biến", "Viêm phế quản"], 
              foods: ["Cháo cá", "Canh hầm thập cẩm", "Trà sâm"] },
            { name: "ĐẠI TUYẾT", startDay: 7, startMonth: 12, endDay: 8, endMonth: 12, degree: 255, season: "winter", duration: 15, 
              description: "Tuyết rơi nhiều.", 
              diseases: ["Viêm phổi", "Cước tay chân", "Đau thắt ngực"], 
              foods: ["Lẩu", "Cháo nóng", "Trà gừng quế"] },
            { name: "ĐÔNG CHÍ", startDay: 21, startMonth: 12, endDay: 22, endMonth: 12, degree: 270, season: "winter", duration: 15, 
              description: "Ngày ngắn nhất trong năm.", 
              diseases: ["Trầm cảm mùa đông", "Đau khớp", "Tim mạch"], 
              foods: ["Cháo gà", "Canh hầm xương", "Trà nhân sâm"] },
            { name: "TIỂU HÀN", startDay: 5, startMonth: 1, endDay: 6, endMonth: 1, degree: 285, season: "winter", duration: 15, 
              description: "Rét nhẹ.", 
              diseases: ["Cảm lạnh", "Viêm họng", "Đau dây thần kinh"], 
              foods: ["Cháo thịt băm", "Canh khoai sọ", "Trà gừng mật ong"] },
            { name: "ĐẠI HÀN", startDay: 20, startMonth: 1, endDay: 21, endMonth: 1, degree: 300, season: "winter", duration: 15, 
              description: "Rét đậm nhất trong năm.", 
              diseases: ["Viêm phổi nặng", "Hạ thân nhiệt", "Đột quỵ"], 
              foods: ["Cháo gà hầm sâm", "Lẩu nóng", "Trà quế nhục"] }
        ];

        // Dữ liệu sức khỏe cá nhân
        const healthData = [
            { code: "25993", date: "22/03/2025", symptom: "Hoa mắt, chóng mặt", food: "Tiết khí", birthDate: "01/01/1970" },
            { code: "25993", date: "27/06/2025", symptom: "Dương bất thường", food: "", birthDate: "01/01/1970" },
            { code: "25993", date: "28/06/2025", symptom: "Tim đập mạnh / nhịp yếu", food: "", birthDate: "01/01/1970" },
            { code: "25993", date: "01/07/2025", symptom: "khớp đau", food: "", birthDate: "01/01/1970" },
            { code: "25993", date: "01/07/2025", symptom: "Hoa mắt, chóng mặt", food: "Óc Gan BIA", birthDate: "01/01/1970" },
            { code: "29850", date: "06/07/2025", symptom: "bắt đầu hành kinh", food: "Sokola", birthDate: "15/08/1990" },
            { code: "29850", date: "11/06/2025", symptom: "hết hành kinh", food: "Sokola", birthDate: "15/08/1990" }
        ];

        // Dữ liệu người dùng
        const personData = {
            "25993": { name: "NAM", birthDate: "1970-01-01" },
            "29850": { name: "KA", birthDate: "1990-08-15" },
            "41529": { name: "NA", birthDate: "2013-09-14" },
            "17772": { name: "BA HA", birthDate: "1971-03-13" },
            "16680": { name: "PHO", birthDate: "1975-05-20" }
        };

        // Màu sắc và tên mùa
        const seasons = {
            "spring": { name: "Xuân", color: "#2ecc71" },
            "summer": { name: "Hạ", color: "#e74c3c" },
            "autumn": { name: "Thu", color: "#f39c12" },
            "winter": { name: "Đông", color: "#3498db" }
        };

        // Biến toàn cục
        let selectedYear = new Date().getFullYear();
        let currentDate = new Date();

        // Khởi tạo trang
        document.addEventListener('DOMContentLoaded', function() {
            // Hiển thị ngày hiện tại
            displayCurrentDate();
            
            // Khởi tạo dropdown năm (từ 2020 đến 2030)
            initYearDropdown();
            
            // Khởi tạo dropdown tiết khí
            initTermDropdown();
            
            // Hiển thị tiết khí cho năm hiện tại
            displaySolarTerms(selectedYear);
            
            // Hiển thị tiết khí sắp tới
            displayNextSolarTerm();
            
            // Cập nhật countdown mỗi giây
            setInterval(updateCountdown, 1000);
            
            // Sự kiện cho nút tìm kiếm
            document.getElementById('searchBtn').addEventListener('click', function() {
                selectedYear = parseInt(document.getElementById('yearSelect').value);
                displaySolarTerms(selectedYear);
                displayNextSolarTerm();
            });
            
            // Sự kiện thay đổi năm
            document.getElementById('yearSelect').addEventListener('change', function() {
                selectedYear = parseInt(this.value);
                displaySolarTerms(selectedYear);
                displayNextSolarTerm();
            });
            
            // Sự kiện thay đổi tiết khí
            document.getElementById('termSelect').addEventListener('change', function() {
                const selectedTerm = this.value;
                displayTermDetail(selectedTerm, selectedYear);
            });
            
            // Sự kiện tab
            document.querySelectorAll('.tab-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // Sự kiện chọn người
            document.getElementById('personSelect').addEventListener('change', function() {
                const selectedValue = this.value;
                if (selectedValue && personData[selectedValue]) {
                    document.getElementById('birthDate').value = personData[selectedValue].birthDate;
                }
            });
            
            // Sự kiện phân tích sức khỏe
            document.getElementById('healthAnalysisBtn').addEventListener('click', analyzeHealthData);
        });

        // Hiển thị ngày hiện tại
        function displayCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            const formattedDate = now.toLocaleDateString('vi-VN', options);
            document.getElementById('currentDate').textContent = formattedDate;
            currentDate = now;
        }

        // Khởi tạo dropdown năm
        function initYearDropdown() {
            const yearSelect = document.getElementById('yearSelect');
            const currentYear = new Date().getFullYear();
            
            // Tạo danh sách năm từ 2020 đến 2030
            for (let year = 2020; year <= 2030; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                
                if (year === currentYear) {
                    option.selected = true;
                }
                
                yearSelect.appendChild(option);
            }
        }

        // Khởi tạo dropdown tiết khí
        function initTermDropdown() {
            const termSelect = document.getElementById('termSelect');
            
            // Thêm option mặc định
            const defaultOption = document.createElement('option');
            defaultOption.value = "";
            defaultOption.textContent = "Chọn tiết khí...";
            termSelect.appendChild(defaultOption);
            
            // Thêm tất cả tiết khí
            solarTermsData.forEach(term => {
                const option = document.createElement('option');
                option.value = term.name;
                option.textContent = term.name;
                termSelect.appendChild(option);
            });
        }

        // Hiển thị 24 tiết khí cho năm được chọn
        function displaySolarTerms(year) {
            const tableBody = document.getElementById('solarTermsBody');
            const selectedYearSpan = document.getElementById('selectedYear');
            
            // Cập nhật năm được chọn
            selectedYearSpan.textContent = year;
            
            // Xóa nội dung cũ
            tableBody.innerHTML = '';
            
            // Thêm từng tiết khí vào bảng
            solarTermsData.forEach(term => {
                const row = document.createElement('tr');
                
                // Tính toán ngày tháng cho năm được chọn
                const startDate = formatDate(term.startDay, term.startMonth, year);
                const endDate = formatDate(term.endDay, term.endMonth, year);
                
                // Lấy thông tin mùa
                const season = seasons[term.season];
                
                // Tạo nội dung hàng
                row.innerHTML = `
                    <td>
                        <div class="season-indicator" style="background-color: ${season.color}"></div>
                        <strong>${term.name}</strong>
                    </td>
                    <td>${startDate}</td>
                    <td>${endDate}</td>
                    <td>${term.degree}°</td>
                    <td><span class="season-tag ${term.season}">${season.name}</span></td>
                    <td>${term.diseases.slice(0, 2).join(", ")}</td>
                `;
                
                // Thêm sự kiện click để hiển thị chi tiết
                row.addEventListener('click', function() {
                    displayTermDetail(term.name, year);
                    // Chuyển sang tab chi tiết
                    switchTab('solar-terms');
                    // Cuộn đến phần chi tiết
                    document.getElementById('termDetail').scrollIntoView({ behavior: 'smooth' });
                });
                
                tableBody.appendChild(row);
            });
        }

        // Hiển thị tiết khí sắp tới
        function displayNextSolarTerm() {
            const nextTermInfo = document.getElementById('nextTermInfo');
            const nextTermDisplay = document.getElementById('nextTermDisplay');
            
            // Tìm tiết khí tiếp theo
            const nextTerm = findNextSolarTerm();
            
            if (nextTerm) {
                // Hiển thị trong card
                const startDate = formatDate(nextTerm.startDay, nextTerm.startMonth, selectedYear);
                const endDate = formatDate(nextTerm.endDay, nextTerm.endMonth, selectedYear);
                
                nextTermInfo.innerHTML = `
                    <div class="next-solar-term">
                        <div>
                            <div class="term-name">${nextTerm.name}</div>
                            <div class="term-date">${startDate} - ${endDate}</div>
                        </div>
                        <div class="days-left" id="daysLeft">Đang tính...</div>
                    </div>
                `;
                
                // Hiển thị trong phần coming-soon
                const season = seasons[nextTerm.season];
                nextTermDisplay.innerHTML = `
                    <div class="next-solar-term">
                        <div>
                            <div class="term-name">${nextTerm.name} 
                                <span class="season-tag ${nextTerm.season}">${season.name}</span>
                            </div>
                            <div class="term-date">Bắt đầu: ${startDate}</div>
                            <div class="term-date">Kết thúc: ${endDate}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9rem; color: #7f8c8d; margin-bottom: 5px;">Thời gian còn lại:</div>
                            <div class="days-left" id="comingSoonDaysLeft">Đang tính...</div>
                        </div>
                    </div>
                `;
                
                // Cập nhật countdown ngay lập tức
                updateCountdown();
            } else {
                nextTermInfo.innerHTML = '<p>Không tìm thấy thông tin tiết khí sắp tới.</p>';
                nextTermDisplay.innerHTML = '<p>Không tìm thấy thông tin tiết khí sắp tới.</p>';
            }
        }

        // Tìm tiết khí tiếp theo
        function findNextSolarTerm() {
            const today = new Date();
            const currentYear = today.getFullYear();
            
            // Tìm tất cả tiết khí trong năm hiện tại
            const currentYearTerms = solarTermsData.map(term => {
                const termDate = new Date(currentYear, term.startMonth - 1, term.startDay);
                return {
                    ...term,
                    date: termDate
                };
            });
            
            // Sắp xếp theo ngày
            currentYearTerms.sort((a, b) => a.date - b.date);
            
            // Tìm tiết khí tiếp theo (ngày bắt đầu sau ngày hôm nay)
            for (let term of currentYearTerms) {
                if (term.date > today) {
                    return term;
                }
            }
            
            // Nếu không tìm thấy trong năm nay, lấy tiết khí đầu tiên của năm sau
            const firstTermNextYear = solarTermsData[0];
            return {
                ...firstTermNextYear,
                date: new Date(currentYear + 1, firstTermNextYear.startMonth - 1, firstTermNextYear.startDay)
            };
        }

        // Cập nhật countdown
        function updateCountdown() {
            const nextTerm = findNextSolarTerm();
            
            if (!nextTerm) return;
            
            const now = new Date();
            const nextTermDate = nextTerm.date;
            
            // Tính thời gian còn lại
            const diff = nextTermDate - now;
            
            if (diff <= 0) {
                // Tiết khí đã diễn ra
                document.getElementById('countdown').textContent = "Đang diễn ra";
                document.getElementById('daysLeft').textContent = "Đang diễn ra";
                document.getElementById('comingSoonDaysLeft').textContent = "Đang diễn ra";
                return;
            }
            
            // Tính ngày, giờ, phút, giây
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            // Hiển thị countdown
            document.getElementById('countdown').textContent = `${days} ngày ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('daysLeft').textContent = `${days} ngày`;
            document.getElementById('comingSoonDaysLeft').textContent = `${days} ngày`;
        }

        // Hiển thị chi tiết tiết khí
        function displayTermDetail(termName, year) {
            const termDetail = document.getElementById('termDetail');
            
            // Tìm tiết khí
            const term = solarTermsData.find(t => t.name === termName);
            
            if (!term) {
                termDetail.innerHTML = '<h3>Thông tin chi tiết về tiết khí</h3><p>Không tìm thấy thông tin cho tiết khí này.</p>';
                return;
            }
            
            // Tính toán ngày tháng
            const startDate = formatDate(term.startDay, term.startMonth, year);
            const endDate = formatDate(term.endDay, term.endMonth, year);
            
            // Lấy thông tin mùa
            const season = seasons[term.season];
            
            // Tạo badge cho bệnh
            const diseaseBadges = term.diseases.map(d => `<span class="symptom-badge">${d}</span>`).join(' ');
            
            // Tạo badge cho món ăn
            const foodBadges = term.foods.map(f => `<span class="food-badge">${f}</span>`).join(' ');
            
            // Hiển thị chi tiết
            termDetail.innerHTML = `
                <h3>${term.name} <span class="season-tag ${term.season}">${season.name}</span></h3>
                <p><strong>Thời gian:</strong> ${startDate} - ${endDate} (${term.duration} ngày)</p>
                <p><strong>Độ từ Xuân phân:</strong> ${term.degree}°</p>
                <p><strong>Mô tả:</strong> ${term.description}</p>
                
                <div style="margin-top: 15px;">
                    <p><strong>Bệnh thường gặp:</strong></p>
                    <div style="margin-bottom: 15px;">${diseaseBadges}</div>
                </div>
                
                <div style="margin-top: 15px;">
                    <p><strong>Món ăn phòng tránh:</strong></p>
                    <div>${foodBadges}</div>
                </div>
                
                <div class="info-text" style="margin-top: 20px;">
                    <i class="fas fa-info-circle"></i> Thông tin này dựa trên dữ liệu tiết khí truyền thống và y học cổ truyền.
                </div>
            `;
        }

        // Chuyển tab
        function switchTab(tabId) {
            // Ẩn tất cả các tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Xóa active từ tất cả các tab button
            document.querySelectorAll('.tab-btn').forEach(button => {
                button.classList.remove('active');
            });
            
            // Hiển thị tab được chọn
            document.getElementById(tabId).classList.add('active');
            
            // Thêm active cho tab button được chọn
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
        }

        // Phân tích dữ liệu sức khỏe
        function analyzeHealthData() {
            const birthDateStr = document.getElementById('birthDate').value;
            
            if (!birthDateStr) {
                alert("Vui lòng nhập ngày tháng năm sinh!");
                return;
            }
            
            // Tìm mã người từ ngày sinh
            let personCode = "";
            for (const [code, data] of Object.entries(personData)) {
                if (data.birthDate === birthDateStr) {
                    personCode = code;
                    break;
                }
            }
            
            // Nếu không tìm thấy, sử dụng mã mặc định
            if (!personCode) {
                personCode = "25993"; // Mặc định là NAM
            }
            
            // Lọc dữ liệu cho người được chọn
            const personRecords = healthData.filter(item => item.code === personCode);
            
            // Tính toán thông tin
            const birthDate = new Date(birthDateStr);
            const currentDate = new Date();
            const age = calculateAge(birthDate, currentDate);
            
            // Phân tích triệu chứng
            const symptoms = {};
            const foods = {};
            
            personRecords.forEach(record => {
                // Phân tích triệu chứng
                if (record.symptom) {
                    symptoms[record.symptom] = (symptoms[record.symptom] || 0) + 1;
                }
                
                // Phân tích món ăn
                if (record.food) {
                    foods[record.food] = (foods[record.food] || 0) + 1;
                }
            });
            
            // Sắp xếp triệu chứng và món ăn phổ biến
            const commonSymptoms = Object.entries(symptoms)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
                
            const commonFoods = Object.entries(foods)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            // Hiển thị kết quả
            displayHealthResults(personCode, birthDateStr, age, personRecords.length, commonSymptoms, commonFoods);
        }

        // Hiển thị kết quả phân tích sức khỏe
        function displayHealthResults(personCode, birthDateStr, age, totalRecords, commonSymptoms, commonFoods) {
            const personName = personData[personCode] ? personData[personCode].name : personCode;
            
            // Tạo HTML cho triệu chứng
            const symptomsHTML = commonSymptoms.length > 0 
                ? commonSymptoms.map(([symptom, count]) => 
                    `<div><span class="symptom-badge">${symptom}</span> (${count} lần)</div>`
                  ).join('')
                : '<p>Không có dữ liệu triệu chứng</p>';
            
            // Tạo HTML cho món ăn
            const foodsHTML = commonFoods.length > 0 
                ? commonFoods.map(([food, count]) => 
                    `<div><span class="food-badge">${food}</span> (${count} lần)</div>`
                  ).join('')
                : '<p>Không có dữ liệu món ăn</p>';
            
            // Hiển thị kết quả
            document.getElementById('healthAnalysisResults').innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Mã số:</strong> ${personName} (${personCode})</p>
                        <p><strong>Ngày sinh:</strong> ${formatDateString(birthDateStr)}</p>
                        <p><strong>Tuổi:</strong> ${age} tuổi</p>
                        <p><strong>Số lần ghi nhận bệnh:</strong> ${totalRecords}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Triệu chứng thường gặp:</strong></p>
                        ${symptomsHTML}
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-12">
                        <p><strong>Món ăn/điều trị thường dùng:</strong></p>
                        ${foodsHTML}
                    </div>
                </div>
                <div class="info-text mt-3">
                    <i class="fas fa-info-circle"></i> Dữ liệu dựa trên ghi chép sức khỏe cá nhân
                </div>
            `;
            
            // Hiển thị phần kết quả
            document.getElementById('healthResults').style.display = 'block';
        }

        // Tính tuổi
        function calculateAge(birthDate, currentDate) {
            let age = currentDate.getFullYear() - birthDate.getFullYear();
            const monthDiff = currentDate.getMonth() - birthDate.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && currentDate.getDate() < birthDate.getDate())) {
                age--;
            }
            
            return age;
        }

        // Hàm định dạng ngày tháng
        function formatDate(day, month, year) {
            return `${day.toString().padStart(2, '0')}/${month.toString().padStart(2, '0')}/${year}`;
        }

        function formatDateString(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('vi-VN');
        }
    </script>
</body>
</html>