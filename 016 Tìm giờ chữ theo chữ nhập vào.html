<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>B·∫£ng 23 ch·ªØ + Gi·∫£i m√£ ng√†y gi·ªù</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    font-family:Segoe UI,Tahoma,Arial;
    background:linear-gradient(135deg,#1e3c72,#2a5298);
    padding:20px;
}
.container{
    max-width:1000px;
    margin:auto;
    background:#fff;
    border-radius:20px;
    padding:30px;
}
h2{text-align:center;color:#1e3c72}
.box{
    background:#f4f6ff;
    padding:20px;
    border-radius:15px;
    margin-bottom:20px;
}
input,select,textarea,button{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:2px solid #ccd6ff;
    margin-top:8px;
}
button{
    background:#4a69bd;
    color:#fff;
    border:none;
    cursor:pointer;
}
button:hover{opacity:.9}
textarea{
    height:140px;
    font-family:Consolas,monospace;
}
.result{
    background:#e9ecff;
    padding:10px;
    border-radius:8px;
}
</style>
</head>

<body>
<div class="container">

<h2>üîê M√É H√ìA ‚Äì GI·∫¢I M√É NG√ÄY GI·ªú</h2>

<!-- B∆Ø·ªöC 1 -->
<div class="box">
<b>üîπ B∆∞·ªõc 1: Nh·∫≠p ng√†y & gi·ªù g·ªëc</b>
<input id="dateInput" type="date">
<input id="hourInput" type="number" min="0" max="23" placeholder="Gi·ªù (0‚Äì23)">
<button onclick="calcBaseSeconds()">T√≠nh T‚ÇÄ</button>
<div class="result">T‚ÇÄ: <span id="baseSeconds">Ch∆∞a t√≠nh</span></div>
</div>

<!-- B·∫¢NG 23 -->
<div class="box">
<b>üîπ Chuy·ªÉn ch·ªØ ‚Üí s·ªë (B·∫¢NG 23)</b>

<input id="textInput" placeholder="V√≠ d·ª•: Nguy·ªÖn VƒÉn A">

<select id="mode">
    <option value="forward">B·∫£ng xu√¥i</option>
    <option value="reverse">B·∫£ng ng∆∞·ª£c</option>
</select>

<button onclick="convert23()">Chuy·ªÉn ch·ªØ ‚Üí s·ªë</button>
<div class="result" id="output">Ch∆∞a c√≥ k·∫øt qu·∫£</div>
</div>

<!-- B∆Ø·ªöC 2 -->
<div class="box">
<b>üîπ B∆∞·ªõc 2: Nh·∫≠p chu·ªói s·ªë</b>
<input id="permInput" placeholder="Chu·ªói s·ªë s·∫Ω t·ª± ƒë·ªông ƒë·ªï v√†o ƒë√¢y">
</div>

<!-- B∆Ø·ªöC 3 -->
<div class="box">
<b>üîπ B∆∞·ªõc 3: Ho√°n v·ªã</b>
<button onclick="generatePermutations()">T·∫°o ho√°n v·ªã</button>
<textarea id="permResult"></textarea>
</div>

<!-- B∆Ø·ªöC 4 -->
<div class="box">
<b>üîπ B∆∞·ªõc 4: Gh√©p s·ªë</b>
<button onclick="mergeNumbers()">Gh√©p</button>
<textarea id="mergeResult"></textarea>
</div>

<!-- B∆Ø·ªöC 5 -->
<div class="box">
<b>üîπ B∆∞·ªõc 5: Gi·∫£i m√£ & l·ªçc theo gi·ªù</b>
<input id="filterHour" type="number" min="0" max="23"
       placeholder="L·ªçc theo gi·ªù (b·ªè tr·ªëng = t·∫•t c·∫£)">
<button onclick="decodeToDate()">Gi·∫£i m√£</button>
<textarea id="dateResult"></textarea>
</div>

</div>

<script>
// ===== B·∫¢NG 23 XU√îI =====
const mapForward={
a:1,√†:1,√°:1,·∫£:1,√£:1,·∫°:1,ƒÉ:1,√¢:1,
b:2,c:3,d:4,ƒë:5,
e:6,√®:6,√©:6,√™:6,
g:7,h:8,
i:9,√¨:9,√≠:9,
k:1,l:2,m:3,
n:1,
o:2,√≤:2,√≥:2,√¥:2,∆°:2,
p:3,q:4,r:5,s:6,t:7,
u:8,√π:8,√∫:8,∆∞:8,
v:9,
x:1,
y:2,·ª≥:2,√Ω:2
};

// ===== B·∫¢NG 23 NG∆Ø·ª¢C =====
const mapReverse={
a:3,√†:3,√°:3,·∫£:3,√£:3,·∫°:3,ƒÉ:3,√¢:3,
b:2,c:1,d:9,ƒë:8,
e:7,√®:7,√©:7,√™:7,
g:6,h:5,
i:4,√¨:4,√≠:4,
k:3,l:2,m:1,
n:2,
o:1,√≤:1,√≥:1,√¥:1,∆°:1,
p:9,q:8,r:7,s:6,t:5,
u:4,√π:4,√∫:4,∆∞:4,
v:3,
x:2,
y:1,·ª≥:1,√Ω:1
};

// ===== CHUY·ªÇN CH·ªÆ ‚Üí ƒê·ªî V√ÄO B∆Ø·ªöC 2 =====
function convert23(){
    const text=document.getElementById("textInput").value.toLowerCase();
    const mode=document.getElementById("mode").value;
    const map=mode==="forward"?mapForward:mapReverse;

    let nums=[];
    for(let c of text){
        if(map[c]!==undefined) nums.push(map[c]);
    }

    if(nums.length){
        const result=nums.join('');
        document.getElementById("output").innerText="Chu·ªói s·ªë: "+result;
        document.getElementById("permInput").value=result;
    }else{
        document.getElementById("output").innerText="Kh√¥ng t√¨m th·∫•y ch·ªØ h·ª£p l·ªá";
    }
}

// ===== LOGIC GI·∫¢I M√É NG√ÄY GI·ªú (GI·ªÆ NGUY√äN) =====
let T0=0n, merged=[];

function calcBaseSeconds(){
    const d=document.getElementById("dateInput").value;
    const h=document.getElementById("hourInput").value;
    if(!d||h===""){alert("Nh·∫≠p ƒë·ªß ng√†y & gi·ªù");return;}
    const date=new Date(d+"T00:00:00Z");
    date.setHours(h);
    const base=new Date("1900-01-01T00:00:00Z");
    T0=BigInt(Math.floor((date-base)/1000));
    document.getElementById("baseSeconds").innerText=T0;
}

function generatePermutations(){
    const s=document.getElementById("permInput").value;
    let set=new Set();
    function p(str,l){
        if(l===str.length-1){set.add(str);return;}
        for(let i=l;i<str.length;i++){
            let a=str.split('');
            [a[l],a[i]]=[a[i],a[l]];
            p(a.join(''),l+1);
        }
    }
    p(s,0);
    document.getElementById("permResult").value=[...set].join("\n");
}

function mergeNumbers(){
    merged=[];
    const perms=document.getElementById("permResult").value.split("\n");
    const T=T0.toString();
    perms.forEach(p=>{
        let pos=T.length-(p.length+1);
        if(pos<0)return;
        let d=(parseInt(T[pos])+1)%10;
        let t=T.substring(0,pos)+d+T.substring(pos+1);
        merged.push(t.substring(0,t.length-p.length)+p);
    });
    document.getElementById("mergeResult").value=merged.join("\n");
}

function decodeToDate(){
    const base=new Date("1900-01-01T00:00:00Z");
    const filter=document.getElementById("filterHour").value;
    let out=[];
    merged.forEach(n=>{
        const d=new Date(base.getTime()+Number(BigInt(n))*1000);
        if(filter===""||d.getHours()==filter){
            out.push(n+" ‚Üí "+d.toLocaleString("vi-VN"));
        }
    });
    document.getElementById("dateResult").value=out.join("\n");
}
</script>
</body>
</html>
