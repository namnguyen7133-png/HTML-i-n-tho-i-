<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TRA MÀU XE HỢP MỆNH - CHUẨN 100%</title>
<style>
  body {font-family: Arial; background: linear-gradient(135deg, #1e3c72, #2a5298); margin:0; padding:15px; color:#fff;}
  .box {background: rgba(0,0,0,0.75); border-radius:25px; padding:25px; max-width:700px; margin:0 auto; box-shadow:0 15px 40px rgba(0,0,0,0.8);}
  h1 {font-size:3em; text-align:center; color:#ffeb3b; text-shadow:0 0 20px #fff; margin:0 0 25px;}
  input {width:100%; padding:20px; margin:10px 0; font-size:1.5em; border-radius:15px; border:none; box-sizing:border-box;}
  button {width:100%; padding:22px; font-size:1.8em; background:#ff1744; color:white; border:none; border-radius:15px; font-weight:bold; margin-top:15px 0;}
  button:hover {background:#c4001d;}
  #ketqua {margin-top:30px; padding:25px; background:rgba(255,255,255,0.15); border-radius:20px; font-size:1.6em; line-height:2.3;}
  .color {width:100px; height:100px; border-radius:50%; display:inline-block; margin:12px; border:6px solid #fff; box-shadow:0 8px 20px #000;}
  .note {text-align:center; font-size:1.4em; color:#ffeb3b; margin-top:25px; font-weight:bold;}
</style>
</head>
<body>

<div class="box">
  <h1>TRA MÀU XE HỢP MỆNH</h1>

  <input type="text" id="tenxe" placeholder="Tên xe (VD: SRC, Wave, Exciter)">
  <input type="number" id="dungtich" placeholder="Dung tích xi-lanh (VD: 110)">
  <input type="text" id="acquy" placeholder="Acquy / Mã số (VD: YTX5L)">
  <input type="text" id="tenchu" placeholder="Tên chủ giấy tờ (VD: NAM)">

  <button onclick="tinhMauChuan()">XEM KẾT QUẢ</button>

  <div id="ketqua"></div>
  <div class="note">Màu nào xuất hiện nhiều lần nhất = HỢP MỆNH NHẤT!</div>
</div>

<script>
// Bảng chữ cái B24 - XUÔI & NGƯỢC
const B24 = {
  xuoi: {A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:10,K:11,L:12,M:13,N:14,O:15,P:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24},
  nguoc:{A:24,B:23,C:22,D:21,E:20,F:19,G:18,H:17,I:16,J:15,K:14,L:13,M:12,N:11,O:10,P:9,R:8,S:7,T:6,U:5,V:4,W:3,X:2,Y:1}
};

// Thêm chữ thường + có dấu
Object.assign(B24.xuoi, {
  a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9,j:10,k:11,l:12,m:13,n:14,o:15,p:16,r:17,s:18,t:19,u:20,v:21,w:22,x:23,y:24,
  à:1,á:1,ả:1,ã:1,ạ:1,ă:1,ằ:1,ắ:1,ẳ:1,ẵ:1,ặ:1,â:1,ầ:1,ấ:1,ẩ:1,ẫ:1,ậ:1,
  è:5,é:5,ẻ:5,ẽ:5,ẹ:5,ê:5,ề:5,ế:5,ể:5,ễ:5,ệ:5,
  ì:9,í:9,ỉ:9,ĩ:9,ị:9,
  ò:15,ó:15,ỏ:15,õ:15,ọ:15,ô:15,ồ:15,ố:15,ổ:15,ỗ:15,ộ:15,ơ:15,ờ:15,ớ:15,ở:15,ỡ:15,ợ:15,
  ù:20,ú:20,ủ:20,ũ:20,ụ:20,ư:20,ừ:20,ứ:20,ử:20,ữ:20,ự:20,
  ỳ:24,ý:24,ỷ:24,ỹ:24
});
Object.assign(B24.nguoc, {
  a:24,b:23,c:22,d:21,e:20,f:19,g:18,h:17,i:16,j:15,k:14,l:13,m:12,n:11,o:10,p:9,r:8,s:7,t:6,u:5,v:4,w:3,x:2,y:1,
  à:24,á:24,ả:24,ã:24,ạ:24,ă:24,ằ:24,ắ:24,ẳ:24,ẵ:24,ặ:24,â:24,ầ:24,ấ:24,ẩ:24,ẫ:24,ậ:24,
  è:20,é:20,ẻ:20,ẽ:20,ẹ:20,ê:20,ề:20,ế:20,ể:20,ễ:20,ệ:20,
  ì:16,í:16,ỉ:16,ĩ:16,ị:16,
  ò:10,ó:10,ỏ:10,õ:10,ọ:10,ô:10,ồ:10,ố:10,ổ:10,ỗ:10,ộ:10,ơ:10,ờ:10,ớ:10,ở:10,ỡ:10,ợ:10,
  ù:5,ú:5,ủ:5,ũ:5,ụ:5,ư:5,ừ:5,ứ:5,ử:5,ữ:5,ự:5,
  ỳ:1,ý:1,ỷ:1,ỹ:1
});

// 6 BẢNG MÀU đúng thứ tự bạn đưa
const bangMau = [
  // Bảng 1
  ["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["TRẮNG","#ffffff"],["LỤC","#00ff00"],["LAM","#0000ff"],
  ["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["TRẮNG","#ffffff"],["LỤC","#00ff00"],["LAM","#0000ff"],
  ["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["TRẮNG","#ffffff"],["LỤC","#00ff00"],
  // Bảng 2
  ["ĐEN","#000000"],["TRẮNG","#ffffff"],["HB","#ff00ff"],["LAM","#0000ff"],["LỤC","#00ff00"],
  ["TÍM","#800080"],["ĐỎ","#ff0000"],["CAM","#ff8c00"],["VÀNG","#ffff00"],["ĐEN","#000000"],
  ["TRẮNG","#ffffff"],["HB","#ff00ff"],["LAM","#0000ff"],["LỤC","#00ff00"],
  // Bảng 3
  ["VÀNG","#ffff00"],["ĐỎ","#ff0000"],["HỒNG","#ff69b4"],["GHI","#808080"],["TRẮNG","#ffffff"],
  ["ĐEN","#000000"],["HB","#ff00ff"],["LAM","#0000ff"],["VÀNG","#ffff00"],["ĐỎ","#ff0000"],
  ["HỒNG","#ff69b4"],["GHI","#808080"],["TRẮNG","#ffffff"],["ĐEN","#000000"],
  // Bảng 4
  ["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["CAM","#ff8c00"],["LỤC","#00ff00"],["LAM","#0000ff"],
  ["CHÀM","#4b0082"],["TÍM","#800080"],["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["CAM","#ff8c00"],
  ["LỤC","#00ff00"],["LAM","#0000ff"],["CHÀM","#4b0082"],["TÍM","#800080"],
  // Bảng 5
  ["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["LAM","#0000ff"],["ĐỎ","#ff0000"],["VÀNG","#ffff00"],
  ["LAM","#0000ff"],["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["LAM","#0000ff"],["ĐỎ","#ff0000"],
  ["VÀNG","#ffff00"],["LAM","#0000ff"],["ĐỎ","#ff0000"],["VÀNG","#ffff00"],
  // Bảng 6
  ["LAM","#0000ff"],["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["ĐEN","#000000"],["LAM","#0000ff"],
  ["ĐỎ","#ff0000"],["VÀNG","#ffff00"],["ĐEN","#000000"],["LAM","#0000ff"],["ĐỎ","#ff0000"],
  ["VÀNG","#ffff00"],["ĐEN","#000000"],["LAM","#0000ff"],["ĐỎ","#ff0000"]
];

// Hàm ghép số từng chữ cái → 14113
function ghepSo(ten, xuoiHayNguoc) {
  let str = "";
  ten = ten.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
  for (let c of ten) {
    let val = B24[xuoiHayNguoc][c];
    if (val) str += val;
  }
  return str; // "14113"
}

// Lấy chữ số cuối (hàng đơn vị)
function layChuSoCuoi(so) {
  if (so == 0) return 0;
  return so % 10;
}

// Tra màu theo số (1-14)
function traBangMau(so) {
  if (so <= 0) return null;
  let idx = (so - 1) % 14; // 1→0, 2→1, ..., 14→13, 15→0
  return bangMau[idx];
}

function tinhMauChuan() {
  const tenxe = document.getElementById("tenxe").value.trim();
  const dt = parseInt(document.getElementById("dungtich").value);
  const tenchu = document.getElementById("tenchu").value.trim();

  if (!tenchu || !dt) {
    alert("Nhập đầy đủ Tên chủ và Dung tích xi-lanh!");
    return;
  }

  let html = `<b style="color:#ffeb3b;font-size:1.8em">KẾT QUẢ</b><br><br>`;
  html += `Tên chủ: <b>${tenchu}</b> | Xe: <b>${tenxe||"-"}</b> | Dung tích: <b>${dt}cc</b><br><br>`;

  const ketQuaMau = {};

  ["xuoi","nguoc"].forEach(loai => {
    const daySo = ghepSo(tenchu, loai);           // "14113"
    const soLon = parseInt(daySo);                  // 14113
    const thuong = Math.floor(soLon / dt);          // 128
    const du = soLon % dt;                          // 33
    const so1 = layChuSoCuoi(thuong);              // 8
    const so2 = layChuSoCuoi(du);                  // 3

    html += `<b>${loai==="xuoi"?"XUÔI":"NGƯỢC"}</b><br>`;
    html += `${tenchu} = <b>${daySo}</b><br>`;
    html += `${daySo} ÷ ${dt} = ${thuong} dư ${du}<br>`;
    html += `→ Chữ số cuối: <b>${so1}</b> và <b>${so2}</b><br><br>`;

    // Tra 2 số này trong 6 bảng
    [so1, so2].forEach(n => {
      if (n > 0) {
        const mau = traBangMau(n);
        if (mau) {
          const [ten, hex] = mau;
          if (!ketQuaMau[ten]) ketQuaMau[ten] = {hex, count:0};
          ketQuaMau[ten].count++;
        }
      }
    });
  });

  // Hiển thị màu hợp
  html += `<b style="font-size:2em;color:#ffeb3b">MÀU HỢP MỆNH</b><br><br>`;
  const sorted = Object.entries(ketQuaMau).sort((a,b)=>b[1].count - a[1].count);
  sorted.forEach(([ten, info]) => {
    html += `<span class="color" style="background:${info.hex}"></span> `;
    html += `<b>${ten}</b> (${info.count} lần)<br>`;
    html += `<code style="background:#000;padding:8px;border-radius:10px">${info.hex}</code><br><br>`;
  });

  document.getElementById("ketqua").innerHTML = html;
}
</script>

</body>
</html>